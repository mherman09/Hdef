#!/bin/bash

#####
#	SET PATH TO TEST_VALUES SCRIPT
#####
TEST_BIN_DIR=$(echo $0 | xargs dirname)


#####
#	SET PATH TO HDEF EXECUTABLE
#####
# Check for o92util
$TEST_BIN_DIR/test_find_hdef_exec.sh o92util || { echo "$0: could not find o92util; exiting" 1>&2; exit 1; }
BIN_DIR=$(cat hdefexec.tmp | xargs dirname)

# Check for o92util -parallel option
$BIN_DIR/o92util -parallel-check
IS_O92UTIL_PARALLEL=$($BIN_DIR/o92util -parallel-check | grep "o92util: compiled with OpenMP" | awk 'BEGIN{found="N"}{if(/[a-z]/){found="Y"}}END{print found}')
echo $IS_O92UTIL_PARALLEL


#####
#	RUN TEST
#####
trap "rm -f *.tmp" 0 1 2 3 8 9


echo "----------------------------------------------------------"
echo "Test #1: Fault file input, displacement and strain output"
echo "----------"
# Fault file input, displacement and strain output
echo 48.7 49.1 11.2 25 76 -132 1.5 4.9 6.4 > flt.tmp
cat > sta.tmp << EOF
48.3 48.3 0.0
49.3 48.3 0.0
49.3 49.3 1.0
48.3 49.3 0.0
EOF
#echo lame 40e9 40e9 > haf.tmp
#o92util -flt flt.tmp -sta sta.tmp -disp disp.tmp -strain strain.tmp -haf haf.tmp
$BIN_DIR/o92util -flt flt.tmp -sta sta.tmp -disp disp.tmp -strain strain.tmp || exit 1
cat > answer.tmp << EOF
   48.299999999999997        48.299999999999997        0.0000000000000000        1.5805317427851058E-004  -2.3604614842163930E-004   2.8040220357723848E-005
   49.299999999999997        48.299999999999997        0.0000000000000000        3.2644282656529915E-004  -6.3753967941883641E-004  -1.2309484389809238E-004
   49.299999999999997        49.299999999999997        1.0000000000000000       -2.7215642253313444E-003  -1.4000563159753576E-003  -1.0790382873926448E-005
   48.299999999999997        49.299999999999997        0.0000000000000000       -4.2676513197687496E-003   4.2357021267820094E-003   1.1564991638417050E-003
EOF
$TEST_BIN_DIR/test_values.sh disp.tmp answer.tmp 6 "o92util: flt input, disp output" || exit 1
cat > answer.tmp << EOF
   48.299999999999997        48.299999999999997        0.0000000000000000       -7.2303940702735573E-010  -9.6191340134039561E-010   5.6165093629310700E-010  -4.6093093922382619E-009  -2.7635669853291311E-021  -1.7160754588179454E-022
   49.299999999999997        48.299999999999997        0.0000000000000000       -5.8230608503956411E-010  -9.4935754289783330E-009   3.3586271713384775E-009   6.8667356059719260E-009  -3.7424622145359124E-022  -4.4121151653933028E-022
   49.299999999999997        49.299999999999997        1.0000000000000000        9.3905926851187105E-008   5.4253342737373626E-009  -3.3030337472570604E-008   7.3565880355188549E-008  -4.6609348128684193E-009  -2.5210307488185848E-009
   48.299999999999997        49.299999999999997        0.0000000000000000       -1.9890388895262303E-007   1.0217557547380974E-008   6.2895443801748052E-008   2.0072000061532723E-007  -4.0482339315170810E-022  -1.6352718120662996E-022
EOF
$TEST_BIN_DIR/test_values.sh strain.tmp answer.tmp 9 "o92util: flt input, strain output" || exit 1


echo "----------------------------------------------------------"
echo "Test #2: Magnitude file input, displacement and strain output"
echo "----------"
# Magnitude file input, displacement and strain output
echo 48.7 49.1 11.2 25 18 82 6.3 > mag.tmp
cat > sta.tmp << EOF
48.3 48.3 0.0
49.3 48.3 0.0
49.3 49.3 1.0
48.3 49.3 0.0
EOF
#echo lame 40e9 40e9 > haf.tmp
#o92util -mag mag.tmp -sta sta.tmp -disp disp.tmp -strain strain.tmp -haf haf.tmp
$BIN_DIR/o92util -mag mag.tmp -sta sta.tmp -disp disp.tmp -strain strain.tmp || exit 1
cat > answer.tmp << EOF
   48.299999999999997        48.299999999999997        0.0000000000000000       -3.5393395949412781E-005   1.1401656392254210E-004  -1.8591757683774509E-004
   49.299999999999997        48.299999999999997        0.0000000000000000       -6.0366539320161035E-004   8.5017095587964619E-004  -5.4974448880161075E-005
   49.299999999999997        49.299999999999997        1.0000000000000000       -2.2342352518426533E-003  -5.1199102694690852E-004  -7.2681239339385218E-004
   48.299999999999997        49.299999999999997        0.0000000000000000       -2.5795762306003234E-004   4.6761160715508103E-004   9.4958413409363535E-004
EOF
$TEST_BIN_DIR/test_values.sh disp.tmp answer.tmp 6 "o92util: mag input, disp output" || exit 1
cat > answer.tmp << EOF
   48.299999999999997        48.299999999999997        0.0000000000000000       -1.7677565613925514E-009  -4.5730167607966796E-010   7.4168607916545093E-010   5.2348281363135863E-009  -4.9774150502567332E-022   5.4353748318236034E-023
   49.299999999999997        48.299999999999997        0.0000000000000000       -5.6382245390818721E-009   1.9856262638886188E-008  -4.7393460332678656E-009  -1.0745428070901282E-008   2.9531944160633786E-023  -1.3826797709394983E-022
   49.299999999999997        49.299999999999997        1.0000000000000000        2.5303814304227497E-008   1.6806606344780625E-008  -1.3992244060995743E-008   9.1209737495935997E-008  -2.8071071253434435E-009  -2.3400862804067349E-009
   48.299999999999997        49.299999999999997        0.0000000000000000       -1.3834166113696379E-007  -3.1687688802198963E-008   5.6676449979720921E-008   1.2827594279523781E-007  -7.3226223485018587E-023  -1.1005951722697728E-022
EOF
$TEST_BIN_DIR/test_values.sh strain.tmp answer.tmp 9 "o92util: mag input, strain output" || exit 1


echo "----------------------------------------------------------"
echo "Test #3: Point source input, displacement and strain output"
echo "----------"
# Point source
#echo lame 40e9 40e9 > haf.tmp
#o92util -mag mag.tmp -sta sta.tmp -haf haf.tmp -disp disp.tmp -strain strain.tmp -pt
$BIN_DIR/o92util -mag mag.tmp -sta sta.tmp -disp disp.tmp -strain strain.tmp -pt || exit 1
cat > answer.tmp << EOF
   48.299999999999997        48.299999999999997        0.0000000000000000       -3.4500415236828915E-005   1.1240253203129917E-004  -1.8521180724348117E-004
   49.299999999999997        48.299999999999997        0.0000000000000000       -5.9811067305189005E-004   8.4774085686302296E-004  -5.3844554161807230E-005
   49.299999999999997        49.299999999999997        1.0000000000000000       -2.1244147562495441E-003  -5.2551729474581172E-004  -6.9842706350821231E-004
   48.299999999999997        49.299999999999997        0.0000000000000000       -2.7071641214039234E-004   5.0389247536941737E-004   9.7413110289171114E-004
EOF
$TEST_BIN_DIR/test_values.sh disp.tmp answer.tmp 6 "o92util: mag input, point source, disp output" || exit 1
cat > answer.tmp << EOF
   48.299999999999997        48.299999999999997        0.0000000000000000       -1.7409131201239048E-009  -4.7671065588715351E-010   7.3920792533702082E-010   5.1570198767664529E-009  -2.8113008641595813E-025   1.3109311223353782E-025
   49.299999999999997        48.299999999999997        0.0000000000000000       -5.7808930763543362E-009   1.9852945359722470E-008  -4.6906840944560410E-009  -1.0549981045147793E-008  -1.4488434956880901E-024  -1.1497788282623425E-024
   49.299999999999997        49.299999999999997        1.0000000000000000        1.8249395765120471E-008   2.0689819830172592E-008  -1.2931981001332965E-008   8.8527602934057413E-008  -2.5978587821554634E-009  -2.3883203137023568E-009
   48.299999999999997        49.299999999999997        0.0000000000000000       -1.3691754100108964E-007  -3.3181544674976315E-008   5.6699695225355329E-008   1.3301961246735237E-007   5.9974418435404404E-024  -2.7966530609821404E-024
EOF
$TEST_BIN_DIR/test_values.sh strain.tmp answer.tmp 9 "o92util: mag input, point source, strain output" || exit 1


echo "----------------------------------------------------------"
echo "Test #4: Empirical relation test"
echo "----------"
# Empirical relation
cat > sta.tmp << EOF
48.65 49.05 0.0
48.78 48.93 0.0
49.01 49.17 1.0
48.60 49.02 0.0
EOF
echo "Wells and Coppersmith (1994)"
#echo lame 40e9 40e9 > haf.tmp
#o92util -mag mag.tmp -sta sta.tmp -haf haf.tmp -disp disp.tmp -empirical WC
$BIN_DIR/o92util -mag mag.tmp -sta sta.tmp -disp disp.tmp -empirical WC || exit 1
cat > answer.tmp << EOF
   48.649999999999999        49.049999999999997        0.0000000000000000       -1.2986652411156010E-002  -8.9385452765298069E-003   4.6930089901591532E-002
   48.780000000000001        48.930000000000000        0.0000000000000000       -9.5374915892814036E-003   1.8696569606729885E-002  -1.2877073373547957E-002
   49.009999999999998        49.170000000000002        1.0000000000000000       -1.1999782106641115E-002  -1.1731288144817388E-003  -6.3927065032077139E-003
   48.600000000000001        49.020000000000003        0.0000000000000000       -1.6128909411642377E-002  -1.4595535513228459E-002   3.0001502577255791E-002
EOF
$TEST_BIN_DIR/test_values.sh disp.tmp answer.tmp 6 "o92util: mag input, disp output, Wells and Coppersmith (1994)" || exit 1
echo "Mai and Beroza (2000)"
#echo lame 40e9 40e9 > haf.tmp
#o92util -mag mag.tmp -sta sta.tmp -haf haf.tmp -disp disp.tmp -empirical MB
$BIN_DIR/o92util -mag mag.tmp -sta sta.tmp -disp disp.tmp -empirical MB || exit 1
cat > answer.tmp << EOF
   48.649999999999999        49.049999999999997        0.0000000000000000       -1.5739994203397688E-002  -1.4284184320716507E-002   4.3105191627647324E-002
   48.780000000000001        48.930000000000000        0.0000000000000000       -8.2226473459557324E-003   1.8610373109521249E-002  -1.1825618585611809E-002
   49.009999999999998        49.170000000000002        1.0000000000000000       -1.1234867202005649E-002  -1.6141129983032240E-003  -5.7684463972012484E-003
   48.600000000000001        49.020000000000003        0.0000000000000000       -1.4951233462945607E-002  -1.5642379281830075E-002   2.2550674996238355E-002
EOF
$TEST_BIN_DIR/test_values.sh disp.tmp answer.tmp 6 "o92util: mag input, disp output, Mai and Beroza (2000)" || exit 1
echo "Blaser et al. (2010)"
#echo lame 40e9 40e9 > haf.tmp
#o92util -mag mag.tmp -sta sta.tmp -haf haf.tmp -disp disp.tmp -empirical B
$BIN_DIR/o92util -mag mag.tmp -sta sta.tmp -disp disp.tmp -empirical B || exit 1
cat > answer.tmp << EOF
   48.649999999999999        49.049999999999997        0.0000000000000000       -1.3867474542488517E-002  -7.9015363406187804E-003   4.3263404933917206E-002
   48.780000000000001        48.930000000000000        0.0000000000000000       -9.2445610571206538E-003   1.8313909406818599E-002  -1.2508369269294571E-002
   49.009999999999998        49.170000000000002        1.0000000000000000       -1.1749670332590346E-002  -1.1653002451275374E-003  -6.2307426601145447E-003
   48.600000000000001        49.020000000000003        0.0000000000000000       -1.5641832731811963E-002  -1.3689366626709526E-002   2.7612329948140734E-002
EOF
$TEST_BIN_DIR/test_values.sh disp.tmp answer.tmp 6 "o92util: mag input, disp output, Blaser et al. (2010)" || exit 1
echo "Yen and Ma (2011)"
#echo lame 40e9 40e9 > haf.tmp
#o92util -mag mag.tmp -sta sta.tmp -haf haf.tmp -disp disp.tmp -empirical YM
$BIN_DIR/o92util -mag mag.tmp -sta sta.tmp -disp disp.tmp -empirical YM || exit 1
cat > answer.tmp << EOF
   48.649999999999999        49.049999999999997        0.0000000000000000       -1.6054952140066546E-002  -8.2425359126261886E-003   3.7860632091482507E-002
   48.780000000000001        48.930000000000000        0.0000000000000000       -8.4108836013938523E-003   1.7811398941282419E-002  -1.1640152081253803E-002
   49.009999999999998        49.170000000000002        1.0000000000000000       -1.1136095980240257E-002  -1.3152960479486126E-003  -5.7651948302776430E-003
   48.600000000000001        49.020000000000003        0.0000000000000000       -1.4794844045974070E-002  -1.2888636109018858E-002   2.2240085597007273E-002
EOF
$TEST_BIN_DIR/test_values.sh disp.tmp answer.tmp 6 "o92util: mag input, disp output, Yen and Ma (2011)" || exit 1
echo "Allen and Hayes (2017)"
#echo lame 40e9 40e9 > haf.tmp
#o92util -mag mag.tmp -sta sta.tmp -haf haf.tmp -disp disp.tmp -empirical AH
$BIN_DIR/o92util -mag mag.tmp -sta sta.tmp -disp disp.tmp -empirical AH || exit 1
cat > answer.tmp << EOF
   48.649999999999999        49.049999999999997        0.0000000000000000       -1.6792270552873845E-002  -9.0139152917137685E-003   3.6258981015576681E-002
   48.780000000000001        48.930000000000000        0.0000000000000000       -8.0706946103599984E-003   1.7703438220779511E-002  -1.1322783943521070E-002
   49.009999999999998        49.170000000000002        1.0000000000000000       -1.0904963008716375E-002  -1.4036711440205980E-003  -5.5801836036745182E-003
   48.600000000000001        49.020000000000003        0.0000000000000000       -1.4435975306815198E-002  -1.2821754214562874E-002   2.0328125279555270E-002
EOF
$TEST_BIN_DIR/test_values.sh disp.tmp answer.tmp 6 "o92util: mag input, disp output, Allen and Hayes (2017)" || exit 1


echo "----------------------------------------------------------"
echo "Test #5: USGS .param format, displacement and strain output"
echo "----------"
# Finite fault model in USGS param format input, disp and strain output
cat > ffm.tmp << EOF
#Total number of fault_segments=     1
#Fault_segment =   1 nx(Along-strike)=  14 Dx=  7.00km ny(downdip)=  15 Dy=  5.60km
#Boundary of Fault_segment     1. EQ in cell 7,5. Lon: 124.8700   Lat: -8.1500
#Lon.  Lat.  Depth
      124.41430       -8.11740        1.07070
      125.22390       -7.78050        1.07070
      125.49370       -8.41570       32.78750
      124.68410       -8.75260       32.78750
      124.41430       -8.11740        1.07070
#Lat. Lon. depth slip rake strike dip t_rup t_ris t_fal mo
      -8.121100     124.429700       1.499300      31.762280      58.550970      67.200000      22.500000      29.000000       2.700000       0.900000   3.886149e+24
      -8.096700     124.488400       1.499300      94.583920      67.630390      67.200000      22.500000      26.400000       0.900000       0.900000   1.157245e+25
      -8.072300     124.547100       1.499300      64.488220      72.226070      67.200000      22.500000      24.800000       1.800000       2.700000   7.890203e+24
      -8.047800     124.605700       1.499300       2.740050      46.702560      67.200000      22.500000      20.000000       0.900000       3.600000   3.352482e+23
      -8.023400     124.664400       1.499300       0.248810      66.424820      67.200000      22.500000      17.000000       4.500000       0.900000   3.044235e+22
      -7.999000     124.723100       1.499300      19.355730      65.786940      67.200000      22.500000      11.400000       4.500000       3.600000   2.368195e+24
      -7.974600     124.781700       1.499300      48.924690      70.407730      67.200000      22.500000       8.000000       0.900000       1.800000   5.985987e+24
      -7.950200     124.840400       1.499300      57.459720      64.515930      67.200000      22.500000       8.400001       0.900000       1.800000   7.030259e+24
      -7.925800     124.899000       1.499300      23.158510      66.971950      67.200000      22.500000       9.400001       0.900000       3.600000   2.833469e+24
      -7.901400     124.957700       1.499300       1.969260      71.395680      67.200000      22.500000      12.600000       4.500000       1.800000   2.409412e+23
      -7.877000     125.016400       1.499300       6.154890      80.001370      67.200000      22.500000      13.800000       2.700000       2.700000   7.530574e+23
      -7.852600     125.075000       1.499300      39.155870      64.334610      67.200000      22.500000      15.200000       0.900000       0.900000   4.790762e+24
      -7.828100     125.133700       1.499300       6.417030      65.791370      67.200000      22.500000      17.600000       0.900000       0.900000   7.851309e+23
      -7.803700     125.192400       1.499300       2.245040      80.263690      67.200000      22.500000      20.600000       4.500000       4.500000   2.746830e+23
      -8.164000     124.448000       3.642300      83.129760      46.653090      67.200000      22.500000      26.600000       0.900000       0.900000   1.017101e+25
      -8.139600     124.506600       3.642300     122.139200      71.003520      67.200000      22.500000      24.800000       0.900000       1.800000   1.494386e+25
      -8.115200     124.565300       3.642300      64.552310      85.009670      67.200000      22.500000      23.400000       4.500000       4.500000   7.898043e+24
      -8.090800     124.623900       3.642300       1.021890      94.710430      67.200000      22.500000      17.800000       4.500000       1.800000   1.250288e+23
      -8.066400     124.682600       3.642300      37.685130      94.057720      67.200000      22.500000      12.600000       4.500000       0.900000   4.610816e+24
      -8.041900     124.741300       3.642300     194.711200      99.724450      67.200000      22.500000       7.800000       0.900000       0.900000   2.382312e+25
      -8.017500     124.799900       3.642300     255.425200      85.257140      67.200000      22.500000       6.200000       1.800000       0.900000   3.125155e+25
      -7.993100     124.858600       3.642300     231.278310      68.246140      67.200000      22.500000       7.400000       2.700000       0.900000   2.829715e+25
      -7.968700     124.917300       3.642300     150.806700      50.486760      67.200000      22.500000       7.200000       0.900000       4.500000   1.845136e+25
      -7.944300     124.975900       3.642300      24.227280      62.056690      67.200000      22.500000      10.000000       4.500000       3.600000   2.964233e+24
      -7.919900     125.034600       3.642300      43.727590      90.855090      67.200000      22.500000      13.000000       2.700000       4.500000   5.350117e+24
      -7.895500     125.093300       3.642300      92.528250      83.290150      67.200000      22.500000      14.600000       0.900000       0.900000   1.132093e+25
      -7.871100     125.151900       3.642300       9.096250      81.877270      67.200000      22.500000      17.200000       1.800000       3.600000   1.112936e+24
      -7.846700     125.210600       3.642300       5.430100      76.164310      67.200000      22.500000      20.200000       2.700000       4.500000   6.643788e+23
      -8.206900     124.466200       5.785300      95.840800      56.024510      67.200000      22.500000      27.200000       3.600000       1.800000   1.172622e+25
      -8.182500     124.524800       5.785300      75.915790      78.025120      67.200000      22.500000      23.000000       2.700000       4.500000   9.288377e+24
      -8.158100     124.583500       5.785300       1.864720      76.791630      67.200000      22.500000      19.600000       0.900000       2.700000   2.281501e+23
      -8.133700     124.642200       5.785300       6.205680      76.155850      67.200000      22.500000      15.000000       0.900000       0.900000   7.592713e+23
      -8.109300     124.700800       5.785300      20.499690      82.461820      67.200000      22.500000      10.200000       0.900000       1.800000   2.508159e+24
      -8.084900     124.759500       5.785300     259.268490      97.230130      67.200000      22.500000       5.000000       0.900000       0.900000   3.172177e+25
      -8.060500     124.818200       5.785300     362.766910      85.237110      67.200000      22.500000       3.600000       1.800000       3.600000   4.438491e+25
      -8.036000     124.876800       5.785300     365.844090      64.691520      67.200000      22.500000       4.600000       0.900000       1.800000   4.476140e+25
      -8.011600     124.935500       5.785300     254.356600      52.712630      67.200000      22.500000       6.000000       0.900000       1.800000   3.112080e+25
      -7.987200     124.994200       5.785300     150.046910      89.133290      67.200000      22.500000       9.400001       0.900000       0.900000   1.835839e+25
      -7.962800     125.052800       5.785300     158.002300      99.570010      67.200000      22.500000      13.200000       3.600000       3.600000   1.933174e+25
      -7.938400     125.111500       5.785300     173.145400      92.261960      67.200000      22.500000      14.600000       0.900000       0.900000   2.118452e+25
      -7.914000     125.170200       5.785300      55.836150     101.169300      67.200000      22.500000      16.800000       0.900000       0.900000   6.831613e+24
      -7.889600     125.228800       5.785300      12.930690      71.612590      67.200000      22.500000      20.600000       0.900000       0.900000   1.582084e+24
      -8.249800     124.484400       7.928400      57.545060      76.665310      67.200000      22.500000      24.200000       4.500000       3.600000   7.040699e+24
      -8.225400     124.543100       7.928400       0.957410      76.771930      67.200000      22.500000      20.600000       4.500000       0.900000   1.171407e+23
      -8.201000     124.601700       7.928400       2.088360      58.287020      67.200000      22.500000      16.800000       1.800000       2.700000   2.555130e+23
      -8.176600     124.660400       7.928400      35.483830      79.577900      67.200000      22.500000      13.400000       3.600000       0.900000   4.341484e+24
      -8.152200     124.719100       7.928400      56.524810      79.794780      67.200000      22.500000       8.000000       2.700000       2.700000   6.915871e+24
      -8.127800     124.777700       7.928400     322.023710      93.623630      67.200000      22.500000       2.800000       1.800000       0.900000   3.939994e+25
      -8.103400     124.836400       7.928400     393.485810      86.509640      67.200000      22.500000       1.400000       4.500000       3.600000   4.814342e+25
      -8.079000     124.895100       7.928400     337.474400      66.827320      67.200000      22.500000       2.400000       0.900000       0.900000   4.129035e+25
      -8.054600     124.953700       7.928400     228.611800      62.400250      67.200000      22.500000       5.400000       2.700000       4.500000   2.797090e+25
      -8.030100     125.012400       7.928400     132.383000      97.653630      67.200000      22.500000       8.600000       1.800000       3.600000   1.619720e+25
      -8.005700     125.071100       7.928400     155.893600      96.580790      67.200000      22.500000      11.800000       2.700000       0.900000   1.907375e+25
      -7.981300     125.129700       7.928400     203.609300     101.880800      67.200000      22.500000      15.400000       1.800000       2.700000   2.491182e+25
      -7.956900     125.188400       7.928400     111.421700     101.012200      67.200000      22.500000      17.600000       0.900000       0.900000   1.363257e+25
      -7.932500     125.247100       7.928400      63.498090     100.939800      67.200000      22.500000      22.400000       4.500000       3.600000   7.769058e+24
      -8.292800     124.502600      10.071400       8.153020      83.498020      67.200000      22.500000      21.800000       0.900000       0.900000   1.051793e+24
      -8.268400     124.561300      10.071400       0.642360      67.373310      67.200000      22.500000      20.200000       4.500000       0.900000   8.286898e+22
      -8.243900     124.620000      10.071400      17.055920      60.767100      67.200000      22.500000      15.600000       4.500000       1.800000   2.200324e+24
      -8.219500     124.678600      10.071400      53.430160      47.233900      67.200000      22.500000      10.000000       0.900000       0.900000   6.892833e+24
      -8.195100     124.737300      10.071400     129.028590      95.639560      67.200000      22.500000       7.000000       4.500000       1.800000   1.664553e+25
      -8.170700     124.796000      10.071400     316.895290      94.531960      67.200000      22.500000       1.400000       0.900000       0.900000   4.088155e+25
      -8.146300     124.854600      10.071400     375.419010      91.319400      67.200000      22.500000       0.200000       0.900000       2.700000   4.843146e+25
      -8.121900     124.913300      10.071400     222.343800      81.335450      67.200000      22.500000       3.800000       4.500000       4.500000   2.868378e+25
      -8.097500     124.972000      10.071400     138.144900      83.848310      67.200000      22.500000       6.800000       4.500000       0.900000   1.782158e+25
      -8.073100     125.030600      10.071400     123.624200      99.122140      67.200000      22.500000       8.200000       1.800000       0.900000   1.594832e+25
      -8.048700     125.089300      10.071400     142.336200      98.382270      67.200000      22.500000      11.800000       2.700000       0.900000   1.836229e+25
      -8.024200     125.147900      10.071400     154.357410      99.419960      67.200000      22.500000      15.800000       1.800000       0.900000   1.991310e+25
      -7.999800     125.206600      10.071400     108.254000      83.621270      67.200000      22.500000      18.600000       0.900000       0.900000   1.396546e+25
      -7.975400     125.265300      10.071400     107.616100      91.072520      67.200000      22.500000      25.600000       1.800000       0.900000   1.388317e+25
      -8.335700     124.520900      12.214400      30.886580      42.769860      67.200000      22.500000      21.200000       1.800000       4.500000   4.806815e+24
      -8.311300     124.579500      12.214400       8.219660      63.575820      67.200000      22.500000      18.200000       4.500000       3.600000   1.279209e+24
      -8.286900     124.638200      12.214400       2.977470     101.688600      67.200000      22.500000      13.600000       0.900000       3.600000   4.633772e+23
      -8.262500     124.696900      12.214400      14.189180      64.039250      67.200000      22.500000      11.200000       3.600000       2.700000   2.208233e+24
      -8.238000     124.755500      12.214400      48.745280      99.422800      67.200000      22.500000       7.200000       1.800000       2.700000   7.586127e+24
      -8.213600     124.814200      12.214400     181.570600     101.141200      67.200000      22.500000       3.400000       4.500000       4.500000   2.825746e+25
      -8.189200     124.872800      12.214400     229.401310     100.501100      67.200000      22.500000       0.800000       0.900000       0.900000   3.570125e+25
      -8.164800     124.931500      12.214400     124.190700      91.008070      67.200000      22.500000       3.800000       4.500000       3.600000   1.932753e+25
      -8.140400     124.990200      12.214400      95.217220      75.363530      67.200000      22.500000       7.600000       4.500000       4.500000   1.481846e+25
      -8.116000     125.048800      12.214400      72.508730      91.912410      67.200000      22.500000      10.000000       4.500000       0.900000   1.128439e+25
      -8.091600     125.107500      12.214400      31.956700     100.129100      67.200000      22.500000      12.600000       0.900000       1.800000   4.973355e+24
      -8.067200     125.166200      12.214400      29.656430      53.246150      67.200000      22.500000      17.800000       0.900000       0.900000   4.615369e+24
      -8.042800     125.224800      12.214400     117.705400      42.541550      67.200000      22.500000      23.400000       4.500000       4.500000   1.831825e+25
      -8.018300     125.283500      12.214400      91.425690      43.872590      67.200000      22.500000      28.800000       2.700000       0.900000   1.422839e+25
      -8.378600     124.539100      14.357400      33.529690      48.756070      67.200000      22.500000      21.200000       0.900000       2.700000   5.218157e+24
      -8.354200     124.597800      14.357400       1.641230      57.403280      67.200000      22.500000      18.600000       4.500000       2.700000   2.554217e+23
      -8.329800     124.656400      14.357400       5.535910      59.913480      67.200000      22.500000      16.200000       4.500000       2.700000   8.615427e+23
      -8.305400     124.715100      14.357400      20.114420      69.578590      67.200000      22.500000      11.000000       0.900000       3.600000   3.130366e+24
      -8.281000     124.773800      14.357400      62.857220      62.076870      67.200000      22.500000       8.800000       2.700000       1.800000   9.782337e+24
      -8.256600     124.832400      14.357400     165.996800      98.831260      67.200000      22.500000       7.000000       1.800000       0.900000   2.583373e+25
      -8.232100     124.891100      14.357400     227.053890      90.050320      67.200000      22.500000       5.600000       3.600000       3.600000   3.533593e+25
      -8.207700     124.949700      14.357400     154.337800      77.987590      67.200000      22.500000       6.400000       4.500000       1.800000   2.401928e+25
      -8.183300     125.008400      14.357400     129.245100      69.884780      67.200000      22.500000       7.800000       3.600000       4.500000   2.011415e+25
      -8.158900     125.067100      14.357400      80.912220      87.970140      67.200000      22.500000      10.800000       1.800000       1.800000   1.259220e+25
      -8.134500     125.125700      14.357400       2.829120      59.812380      67.200000      22.500000      15.600000       2.700000       2.700000   4.402907e+23
      -8.110100     125.184400      14.357400       1.922530      68.755810      67.200000      22.500000      21.800000       1.800000       0.900000   2.991999e+23
      -8.085700     125.243100      14.357400     135.579410      42.299120      67.200000      22.500000      27.800000       1.800000       1.800000   2.109994e+25
      -8.061300     125.301700      14.357400      79.019220      45.193650      67.200000      22.500000      31.400000       1.800000       3.600000   1.229760e+25
      -8.421500     124.557300      16.500500      45.620640      46.717830      67.200000      22.500000      23.400000       0.900000       0.900000   7.099848e+24
      -8.397100     124.616000      16.500500      33.348790      44.010340      67.200000      22.500000      21.000000       1.800000       1.800000   5.190002e+24
      -8.372700     124.674600      16.500500      12.028210      54.582170      67.200000      22.500000      17.600000       4.500000       4.500000   1.871925e+24
      -8.348300     124.733300      16.500500      63.786800      66.532680      67.200000      22.500000      13.400000       2.700000       0.900000   9.927008e+24
      -8.323900     124.792000      16.500500      88.781700      73.398610      67.200000      22.500000       9.800000       4.500000       1.800000   1.381691e+25
      -8.299500     124.850600      16.500500     171.959000      76.692250      67.200000      22.500000       9.200000       2.700000       2.700000   2.676162e+25
      -8.275100     124.909300      16.500500     209.729800      76.267850      67.200000      22.500000       7.800000       2.700000       2.700000   3.263982e+25
      -8.250700     124.968000      16.500500     205.540500      75.105590      67.200000      22.500000       7.800000       1.800000       3.600000   3.198785e+25
      -8.226200     125.026600      16.500500     146.725600      85.272160      67.200000      22.500000       8.600000       3.600000       4.500000   2.283461e+25
      -8.201800     125.085300      16.500500      72.194370      89.007740      67.200000      22.500000      10.600000       0.900000       0.900000   1.123546e+25
      -8.177400     125.144000      16.500500      56.124220      43.258300      67.200000      22.500000      17.400000       3.600000       0.900000   8.734493e+24
      -8.153000     125.202600      16.500500      12.382130      58.552720      67.200000      22.500000      24.000000       4.500000       2.700000   1.927005e+24
      -8.128600     125.261300      16.500500     159.148700      70.695740      67.200000      22.500000      32.000000       3.600000       1.800000   2.476798e+25
      -8.104200     125.320000      16.500500      92.452400      58.572800      67.200000      22.500000      33.600000       0.900000       0.900000   1.438818e+25
      -8.464500     124.575500      18.643500       0.696160      68.072590      67.200000      22.500000      26.800000       0.900000       0.900000   1.083423e+23
      -8.440000     124.634200      18.643500       4.859490      46.063180      67.200000      22.500000      23.400000       0.900000       1.800000   7.562718e+23
      -8.415600     124.692900      18.643500       2.856250      63.492010      67.200000      22.500000      20.000000       2.700000       3.600000   4.445115e+23
      -8.391200     124.751500      18.643500      25.961790      68.045880      67.200000      22.500000      15.000000       0.900000       0.900000   4.040378e+24
      -8.366800     124.810200      18.643500      63.647180      90.078160      67.200000      22.500000      13.000000       1.800000       1.800000   9.905281e+24
      -8.342400     124.868900      18.643500      86.936190      89.389840      67.200000      22.500000      11.600000       2.700000       3.600000   1.352970e+25
      -8.318000     124.927500      18.643500     107.871300      90.835110      67.200000      22.500000      10.000000       0.900000       1.800000   1.678779e+25
      -8.293600     124.986200      18.643500     114.620800      82.074650      67.200000      22.500000      11.000000       3.600000       2.700000   1.783819e+25
      -8.269200     125.044900      18.643500      80.773750      99.503770      67.200000      22.500000      11.600000       2.700000       0.900000   1.257065e+25
      -8.244800     125.103500      18.643500      16.000230      86.155170      67.200000      22.500000      13.200000       1.800000       0.900000   2.490082e+24
      -8.220300     125.162200      18.643500     106.040800      44.901070      67.200000      22.500000      17.800000       0.900000       1.800000   1.650291e+25
      -8.195900     125.220900      18.643500      61.177190      42.836270      67.200000      22.500000      25.400000       4.500000       1.800000   9.520882e+24
      -8.171500     125.279500      18.643500     189.247100      71.081120      67.200000      22.500000      32.400000       0.900000       0.900000   2.945213e+25
      -8.147100     125.338200      18.643500     133.970200      48.605550      67.200000      22.500000      34.800000       0.900000       2.700000   2.084950e+25
      -8.507400     124.593800      20.786500      37.798750      99.448840      67.200000      22.500000      31.200000       1.800000       1.800000   6.762590e+24
      -8.483000     124.652400      20.786500       0.346790      75.344650      67.200000      22.500000      28.400000       4.500000       0.900000   6.204444e+22
      -8.458600     124.711100      20.786500       0.351830      99.292690      67.200000      22.500000      23.800000       3.600000       2.700000   6.294646e+22
      -8.434100     124.769800      20.786500      19.233360      51.143960      67.200000      22.500000      18.600000       1.800000       0.900000   3.441048e+24
      -8.409700     124.828400      20.786500       4.074450      91.582360      67.200000      22.500000      15.600000       4.500000       4.500000   7.289617e+23
      -8.385300     124.887100      20.786500      16.744350      88.200990      67.200000      22.500000      14.000000       3.600000       0.900000   2.995738e+24
      -8.360900     124.945800      20.786500       6.539370      57.651040      67.200000      22.500000      11.800000       0.900000       2.700000   1.169961e+24
      -8.336500     125.004400      20.786500      47.042080      43.892650      67.200000      22.500000      13.800000       4.500000       0.900000   8.416317e+24
      -8.312100     125.063100      20.786500      44.013080      79.283930      67.200000      22.500000      13.400000       2.700000       0.900000   7.874396e+24
      -8.287700     125.121700      20.786500      22.621400      72.195390      67.200000      22.500000      14.400000       0.900000       0.900000   4.047202e+24
      -8.263300     125.180400      20.786500      78.043260      86.090870      67.200000      22.500000      18.400000       2.700000       0.900000   1.396274e+25
      -8.238800     125.239100      20.786500       3.173600      49.274380      67.200000      22.500000      24.200000       0.900000       3.600000   5.677907e+23
      -8.214400     125.297800      20.786500     135.718000      69.875620      67.200000      22.500000      31.400000       1.800000       0.900000   2.428136e+25
      -8.190000     125.356400      20.786500     123.336700      45.763260      67.200000      22.500000      34.200000       0.900000       1.800000   2.206622e+25
      -8.550300     124.612000      22.929600       0.200610      43.577650      67.200000      22.500000      32.800000       0.900000       1.800000   3.900583e+22
      -8.525900     124.670700      22.929600      13.827920     100.057200      67.200000      22.500000      29.400000       0.900000       3.600000   2.688590e+24
      -8.501500     124.729300      22.929600       4.157200      78.103490      67.200000      22.500000      25.400000       2.700000       1.800000   8.082925e+23
      -8.477100     124.788000      22.929600      59.148220      42.834660      67.200000      22.500000      20.200000       1.800000       1.800000   1.150031e+25
      -8.452700     124.846700      22.929600      30.596320      45.054160      67.200000      22.500000      16.600000       4.500000       1.800000   5.948903e+24
      -8.428200     124.905300      22.929600      22.341580      44.115530      67.200000      22.500000      14.600000       0.900000       3.600000   4.343918e+24
      -8.403800     124.964000      22.929600      11.548930      47.669920      67.200000      22.500000      14.000000       4.500000       2.700000   2.245482e+24
      -8.379400     125.022700      22.929600       9.357210      53.755590      67.200000      22.500000      14.600000       2.700000       0.900000   1.819341e+24
      -8.355000     125.081300      22.929600      36.804470      42.458820      67.200000      22.500000      14.600000       2.700000       4.500000   7.155965e+24
      -8.330600     125.140000      22.929600      75.770800      49.647740      67.200000      22.500000      15.200000       0.900000       4.500000   1.473227e+25
      -8.306200     125.198600      22.929600     110.599600      98.744260      67.200000      22.500000      17.200000       0.900000       0.900000   2.150410e+25
      -8.281800     125.257300      22.929600      56.778620      94.238460      67.200000      22.500000      22.000000       0.900000       0.900000   1.103959e+25
      -8.257400     125.316000      22.929600      46.767250      72.876640      67.200000      22.500000      28.800000       3.600000       3.600000   9.093049e+24
      -8.232900     125.374600      22.929600      24.903720      49.879540      67.200000      22.500000      31.600000       4.500000       0.900000   4.842079e+24
      -8.593200     124.630200      25.072600       0.913790      43.392190      67.200000      22.500000      33.800000       0.900000       2.700000   1.776694e+23
      -8.568800     124.688900      25.072600       5.777130      42.426390      67.200000      22.500000      30.200000       0.900000       0.900000   1.123259e+24
      -8.544400     124.747600      25.072600       0.135160      74.043310      67.200000      22.500000      25.800000       1.800000       3.600000   2.627919e+22
      -8.520000     124.806200      25.072600      17.722760      44.956060      67.200000      22.500000      21.000000       0.900000       0.900000   3.445872e+24
      -8.495600     124.864900      25.072600      32.567100      44.020770      67.200000      22.500000      17.200000       0.900000       0.900000   6.332086e+24
      -8.471200     124.923500      25.072600      38.486920      46.528560      67.200000      22.500000      15.800000       0.900000       0.900000   7.483087e+24
      -8.446700     124.982200      25.072600      50.937470      51.031770      67.200000      22.500000      15.200000       2.700000       2.700000   9.903875e+24
      -8.422300     125.040900      25.072600      38.577340      48.946960      67.200000      22.500000      15.400000       0.900000       0.900000   7.500670e+24
      -8.397900     125.099500      25.072600      68.038990      73.995910      67.200000      22.500000      16.800000       4.500000       3.600000   1.322896e+25
      -8.373500     125.158200      25.072600     114.463900      78.125000      67.200000      22.500000      16.800000       0.900000       0.900000   2.225544e+25
      -8.349100     125.216900      25.072600     131.448900      98.157010      67.200000      22.500000      18.200000       0.900000       0.900000   2.555787e+25
      -8.324700     125.275500      25.072600      66.901570     100.443400      67.200000      22.500000      21.400000       0.900000       0.900000   1.300781e+25
      -8.300300     125.334200      25.072600       3.920240      43.600350      67.200000      22.500000      26.200000       3.600000       4.500000   7.622207e+23
      -8.275900     125.392900      25.072600       3.963260      43.540810      67.200000      22.500000      30.400000       0.900000       3.600000   7.705853e+23
      -8.636100     124.648400      27.215600       1.224270      43.013020      67.200000      22.500000      33.400000       4.500000       1.800000   2.380377e+23
      -8.611700     124.707100      27.215600       7.547560      43.517620      67.200000      22.500000      30.400000       1.800000       0.900000   1.467487e+24
      -8.587300     124.765800      27.215600       1.404580      48.560720      67.200000      22.500000      25.400000       4.500000       0.900000   2.730961e+23
      -8.562900     124.824400      27.215600       4.701130      56.554370      67.200000      22.500000      21.200000       0.900000       3.600000   9.140498e+23
      -8.538500     124.883100      27.215600      69.542280      60.223410      67.200000      22.500000      17.800000       0.900000       0.900000   1.352125e+25
      -8.514100     124.941800      27.215600      90.283610      53.281000      67.200000      22.500000      17.800000       2.700000       2.700000   1.755402e+25
      -8.489700     125.000400      27.215600      52.794370      51.529500      67.200000      22.500000      17.000000       0.900000       0.900000   1.026492e+25
      -8.465300     125.059100      27.215600       2.687070      84.209950      67.200000      22.500000      17.200000       0.900000       2.700000   5.224532e+23
      -8.440800     125.117800      27.215600      18.966690      91.453000      67.200000      22.500000      17.800000       0.900000       0.900000   3.687730e+24
      -8.416400     125.176400      27.215600      76.316470      68.640780      67.200000      22.500000      19.800000       3.600000       0.900000   1.483836e+25
      -8.392000     125.235100      27.215600      72.295200      83.609850      67.200000      22.500000      20.400000       1.800000       0.900000   1.405650e+25
      -8.367600     125.293800      27.215600       1.801650      68.860690      67.200000      22.500000      23.000000       3.600000       1.800000   3.502975e+23
      -8.343200     125.352400      27.215600       0.386550      43.388250      67.200000      22.500000      27.200000       1.800000       1.800000   7.515740e+22
      -8.318800     125.411100      27.215600       6.506520      42.277000      67.200000      22.500000      30.600000       4.500000       3.600000   1.265076e+24
      -8.679100     124.666700      29.358600       0.727770      42.542690      67.200000      22.500000      33.000000       2.700000       0.900000   1.415011e+23
      -8.654700     124.725300      29.358600       1.300140      43.865720      67.200000      22.500000      29.000000       4.500000       4.500000   2.527882e+23
      -8.630200     124.784000      29.358600       1.157600      82.451980      67.200000      22.500000      25.800000       0.900000       4.500000   2.250752e+23
      -8.605800     124.842700      29.358600       4.064790      64.988080      67.200000      22.500000      22.600000       3.600000       4.500000   7.903255e+23
      -8.581400     124.901300      29.358600      36.415260      47.245320      67.200000      22.500000      20.000000       0.900000       0.900000   7.080293e+24
      -8.557000     124.960000      29.358600      72.909660      51.347000      67.200000      22.500000      19.800000       1.800000       0.900000   1.417597e+25
      -8.532600     125.018700      29.358600      51.205420      44.252680      67.200000      22.500000      19.400000       0.900000       1.800000   9.955972e+24
      -8.508200     125.077300      29.358600      10.943130      58.523350      67.200000      22.500000      19.800000       0.900000       1.800000   2.127695e+24
      -8.483800     125.136000      29.358600      19.151700      73.598010      67.200000      22.500000      20.400000       0.900000       0.900000   3.723703e+24
      -8.459400     125.194700      29.358600      50.942750      49.753740      67.200000      22.500000      20.600000       1.800000       2.700000   9.904897e+24
      -8.434900     125.253300      29.358600       0.395810      94.599430      67.200000      22.500000      22.000000       0.900000       1.800000   7.695768e+22
      -8.410500     125.312000      29.358600       1.322290      89.352490      67.200000      22.500000      24.400000       0.900000       2.700000   2.570963e+23
      -8.386100     125.370700      29.358600       5.071340      44.145970      67.200000      22.500000      28.800000       4.500000       3.600000   9.860318e+23
      -8.361700     125.429300      29.358600       6.800690      44.262930      67.200000      22.500000      32.000000       4.500000       0.900000   1.322272e+24
      -8.722000     124.684900      31.501700       0.766490      43.775390      67.200000      22.500000      31.800000       4.500000       1.800000   2.029146e+23
      -8.697600     124.743600      31.501700       1.829610      43.376630      67.200000      22.500000      28.400000       0.900000       0.900000   4.843598e+23
      -8.673200     124.802200      31.501700       1.859250      77.845250      67.200000      22.500000      25.800000       3.600000       2.700000   4.922052e+23
      -8.648800     124.860900      31.501700       0.196320      71.102170      67.200000      22.500000      24.600000       4.500000       3.600000   5.197326e+22
      -8.624300     124.919600      31.501700       0.461890      46.552490      67.200000      22.500000      22.200000       2.700000       3.600000   1.222778e+23
      -8.599900     124.978200      31.501700       2.573610      42.316020      67.200000      22.500000      21.600000       2.700000       2.700000   6.813215e+23
      -8.575500     125.036900      31.501700       0.907580      50.779210      67.200000      22.500000      22.000000       1.800000       0.900000   2.402680e+23
      -8.551100     125.095600      31.501700       0.654210      80.284610      67.200000      22.500000      21.600000       0.900000       3.600000   1.731912e+23
      -8.526700     125.154200      31.501700      14.028230      43.078000      67.200000      22.500000      22.400000       0.900000       2.700000   3.713745e+24
      -8.502300     125.212900      31.501700       4.693850      51.392030      67.200000      22.500000      23.000000       0.900000       0.900000   1.242621e+24
      -8.477900     125.271600      31.501700       2.576940      93.270940      67.200000      22.500000      23.800000       4.500000       0.900000   6.822027e+23
      -8.453500     125.330200      31.501700       0.923360      56.398750      67.200000      22.500000      26.400000       2.700000       0.900000   2.444442e+23
      -8.429000     125.388900      31.501700       0.224830      42.951720      67.200000      22.500000      29.000000       4.500000       3.600000   5.952072e+22
      -8.404600     125.447500      31.501700       5.236550      43.968690      67.200000      22.500000      30.200000       2.700000       4.500000   1.386291e+24
EOF
cat > sta.tmp << EOF
126.3 -8.1 0.0
125.3 -8.1 0.0
125.3 -8.1 0.0
126.3 -8.1 0.0
EOF
#echo lame 40e9 40e9 > haf.tmp
#o92util -ffm ffm.tmp -sta sta.tmp -disp disp.tmp -strain strain.tmp -haf haf.tmp
$BIN_DIR/o92util -ffm ffm.tmp -sta sta.tmp -disp disp.tmp -strain strain.tmp || exit 1
cat > answer-dsp.tmp << EOF
  126.30000000000000       -8.0999999999999996        0.0000000000000000        5.4236426651140955E-006   3.4026851126876733E-003  -4.7317357901842452E-003
   125.30000000000000       -8.0999999999999996        0.0000000000000000       -4.5645170341471746E-002  0.25286924622121287       0.15746336610082426
   125.30000000000000       -8.0999999999999996        0.0000000000000000       -4.5645170341471746E-002  0.25286924622121287       0.15746336610082426
   126.30000000000000       -8.0999999999999996        0.0000000000000000        5.4236426651140955E-006   3.4026851126876733E-003  -4.7317357901842452E-003
EOF
$TEST_BIN_DIR/test_values.sh disp.tmp answer-dsp.tmp 6 "o92util: ffm input, disp output" || exit 1
cat > answer-stn.tmp << EOF
   126.30000000000000       -8.0999999999999996        0.0000000000000000       -2.5069710810689036E-008  -6.6694594778138674E-008   3.0588101862945988E-008   4.5464647903852811E-008  -6.0987887208890170E-022   1.4441626921039635E-021
   125.30000000000000       -8.0999999999999996        0.0000000000000000        1.2246395515753101E-005   1.5484485406476490E-006  -4.5982813521336006E-006  -6.2608923308272983E-006   5.5010744657705410E-021  -3.8420605815869637E-021
   125.30000000000000       -8.0999999999999996        0.0000000000000000        1.2246395515753101E-005   1.5484485406476490E-006  -4.5982813521336006E-006  -6.2608923308272983E-006   5.5010744657705410E-021  -3.8420605815869637E-021
   126.30000000000000       -8.0999999999999996        0.0000000000000000       -2.5069710810689036E-008  -6.6694594778138674E-008   3.0588101862945988E-008   4.5464647903852811E-008  -6.0987887208890170E-022   1.4441626921039635E-021
EOF
$TEST_BIN_DIR/test_values.sh strain.tmp answer-stn.tmp 9 "o92util: ffm input, strain output" || exit 1
if [ "$IS_O92UTIL_PARALLEL" == "Y" ]
then
    echo "----------"
    echo "Test #5-parallel"
    echo "----------"
    $BIN_DIR/o92util -ffm ffm.tmp -sta sta.tmp -disp disp.tmp -strain strain.tmp -parallel || exit 1
    $TEST_BIN_DIR/test_values.sh disp.tmp answer-dsp.tmp 6 "o92util -parallel: ffm input, disp output" || exit 1
    $TEST_BIN_DIR/test_values.sh strain.tmp answer-stn.tmp 9 "o92util -parallel: ffm input, strain output" || exit 1
fi


echo "----------------------------------------------------------"
echo "Test #6: SRCMOD .fsp format, displacement and strain output"
echo "----------"
# Finite fault model in SRCMOD FSP format, disp and strain output
cat > fsp.tmp << EOF
% ---------------------------------- FINITE-SOURCE RUPTURE MODEL --------------------------------
%
% Event : NEAR COAST OF CENTRAL CHILE  2010/02/27 [Hayes (NEIC,2014)]
% EventTAG: p000h7rfHAYES
%
% Loc  : LAT = -36.2200  LON = -73.1740  DEP = 25.0
% Size : LEN = 350 km  WID = 53.25 km  Mw = 8.85  Mo = 2.4510603e+22 Nm
% Mech : STRK = 18.7  DIP = 17.5  RAKE = 112  Htop = 3.53 km
% Rupt : HypX = 37.5 km  Hypz = 26.625 km  avTr = 5.9 s  avVr = 2.11 km/s
%
% ---------------------------------- inversion-related parameters --------------------------------
%
% Invs : Nx = 14  Nz = 3  Fmin = 0.002 Hz  Fmax = 1 Hz
% Invs : Dx = 25 km  Dz = 17.75 km
% Invs : Ntw = 8  Nsg = 5    (# of time-windows,# of fault segments)
% Invs : LEN = 3 s  SHF = 1.5 s    (time-window length and time-shift)
% SVF  : Asymetriccosine    (type of slip-velocity function used)
%
% Data : SGM TELE TRIL LEVEL GPS INSAR SURF OTHER
% Data : 0 48 0 0 0 0 48 0
% Data : 0 61.17 0 0 0 0 61.17 0
% Data : 0 36.63 0 0 0 0 36.63 0
%
%--------------------------------------------------------------------------------------------------
%
% VELOCITY-DENSITY STRUCTURE
% No. of layers = 6
%
% DEPTH P-VEL S-VEL DENS QP QS
% [km] [km/s] [km/s] [g/cm^3]
%   0.00 2.50 1.20 2.10  1000   500
%   1.00 6.00 3.40 2.70  1000   500
%  11.00 6.60 3.70 2.90  1000   500
%  22.00 7.20 4.00 3.10  1000   500
%  32.00 8.08 4.47 3.38  1200   500
% 228.00 8.59 4.66 3.45   360   140
%
%--------------------------------------------------------------------------------------------------
% 3-Feb-2017 created by GPH (ghayes@usgs.gov)
%--------------------------------------------------------------------------------------------------
%
% SOURCE MODEL PARAMETERS
% X,Y,Z coordinates in km; SLIP in m
% if applicable: RAKE in deg, RISE in s, TRUP in s, slip in each TW in m
%
% Coordinates are given for center of each subfault or segment: |'|
% Origin of local coordinate system at epicenter: X (EW) = 0, Y (NS) = 0
%--------------------------------------------------------------------------------------------------
%--------------------------- MULTISEGMENT MODEL ---------------------------------------------------
%--------------------------------------------------------------------------------------------------
% SEGMENT # 1: STRIKE = 18.7 deg DIP = 17.5 deg
% LEN = 350 km WID = 53.25 km
% depth to top: Z2top = 16.99 km
% coordinates of top-center:
% LAT = -34.9625012594156, LON = -73.002813177712
% hypocenter on SEG # 1 : along-strike (X) = 37.5, down-dip (Z) = 26.625
% Nsbfs = 42 subfaults
%--------------------------------------------------------------------------------------------------
% LAT LON X==EW Y==NS Z SLIP RAKE TRUP RISE SF_MOMENT
%--------------------------------------------------------------------------------------------------
-36.3843  -73.4423  -32.0372  -15.6045  19.6625  6.3921  122.9948  16.0000  6.0000  1.13e+20
-36.1712  -73.3529  -24.0753    8.1160  19.6625  1.1696   87.6819   4.0000  1.5000  2.06e+19
-35.9581  -73.2635  -16.0695   31.8291  19.6625  0.1471   70.9816  16.0000  3.0000  2.59e+18
-35.7449  -73.1740   -8.0109   55.5460  19.6625  1.4115  125.1143  24.0000 12.0000  2.49e+19
-35.5318  -73.0846    0.0778   79.2442  19.6625  8.6343  102.4856  32.0000  7.5000  1.52e+20
-35.3187  -72.9952    8.2143  102.9294  19.6625 14.4901  108.9657  40.0000  9.0000  2.55e+20
-35.1056  -72.9058   16.3893  126.6127  19.6625 10.3908  120.6460  56.0000 12.0000  1.83e+20
-34.8925  -72.8164   24.6163  150.2885  19.6625  9.2366  102.8717  64.0000  1.5000  1.63e+20
-34.6794  -72.7270   32.8768  173.9569  19.6625  9.1188  128.2137  68.0000 12.0000  1.61e+20
-34.4663  -72.6376   41.1796  197.6176  19.6625  5.9541  109.6114  76.0000  1.5000  1.05e+20
-34.2532  -72.5482   49.5293  221.2708  19.6625  2.3619  128.7441 104.0000 10.5000  4.16e+19
-34.0401  -72.4588   57.9162  244.9165  19.6625  2.2150  148.1253 124.0000  4.5000  3.90e+19
-33.8270  -72.3694   66.3448  268.5545  19.6625  0.9315  144.5585 144.0000  3.0000  1.64e+19
-33.6139  -72.2799   74.8288  292.1849  19.6625  0.1307  125.3914 160.0000  6.0000  2.30e+18
-36.4331  -73.2634  -16.0125  -20.9862  25.0000 12.2985   97.2480   4.0000  1.5000  2.71e+20
-36.2200  -73.1740   -8.0120    2.7195  25.0000  6.6988  112.8563   0.0000  7.5000  1.47e+20
-36.0069  -73.0846    0.0279   26.4178  25.0000  0.2575  147.8169  12.0000  9.0000  5.67e+18
-35.7938  -72.9952    8.1205   50.1087  25.0000  0.9203   85.4143  24.0000 10.5000  2.03e+19
-35.5807  -72.9058   16.2475   73.7920  25.0000  7.9613   92.6950  40.0000  9.0000  1.75e+20
-35.3676  -72.8164   24.4221   97.4624  25.0000 12.1735  105.1502  44.0000  4.5000  2.68e+20
-35.1545  -72.7270   32.6352  121.1308  25.0000  9.7945  121.9535  64.0000  6.0000  2.16e+20
-34.9414  -72.6375   40.9046  144.7916  25.0000  9.8108   91.1716  68.0000  4.5000  2.16e+20
-34.7283  -72.5481   49.2029  168.4449  25.0000 10.5390  100.4897  68.0000  6.0000  2.32e+20
-34.5152  -72.4587   57.5526  192.0906  25.0000  3.9522   84.0947  80.0000  6.0000  8.70e+19
-34.3021  -72.3693   65.9352  215.7288  25.0000  0.3420  147.8737 108.0000  9.0000  7.53e+18
-34.0889  -72.2799   74.3597  239.3706  25.0000  2.1901  125.5808 136.0000 12.0000  4.82e+19
-33.8758  -72.1905   82.8303  262.9935  25.0000  0.2637  135.8309 152.0000  7.5000  5.80e+18
-33.6627  -72.1011   91.3376  286.6089  25.0000  0.0645   92.1426 168.0000 10.5000  1.42e+18
-36.4819  -73.0845   -0.0079  -26.3974  30.3375 16.2212  111.5059  16.0000  1.5000  3.57e+20
-36.2688  -72.9951    8.0314   -2.7066  30.3375 10.4041  120.8134   4.0000  4.5000  2.29e+20
-36.0557  -72.9057   16.1099   20.9769  30.3375  1.4696  158.7084  16.0000  6.0000  3.23e+19
-35.8426  -72.8163   24.2365   44.6529  30.3375  0.0557  135.0947  24.0000  7.5000  1.22e+18
-35.6295  -72.7269   32.4108   68.3213  30.3375  3.9006  115.1179  40.0000  1.5000  8.59e+19
-35.4164  -72.6375   40.6192   91.9767  30.3375  9.6075  128.4157  40.0000  7.5000  2.11e+20
-35.2033  -72.5481   48.8749  115.6302  30.3375 10.5964  103.1460  56.0000  3.0000  2.33e+20
-34.9902  -72.4587   57.1687  139.2761  30.3375 13.0931  102.3453  56.0000  7.5000  2.88e+20
-34.7771  -72.3693   65.5094  162.9144  30.3375 14.0243  107.1655  76.0000  1.5000  3.09e+20
-34.5640  -72.2799   73.8877  186.5451  30.3375  5.2135  118.1755  92.0000 12.0000  1.15e+20
-34.3509  -72.1904   82.3170  210.1682  30.3375  0.8277   78.7801 112.0000  9.0000  1.82e+19
-34.1378  -72.1010   90.7835  233.7837  30.3375  4.2257  114.3804 136.0000 10.5000  9.30e+19
-33.9247  -72.0116   99.2914  257.3916  30.3375  2.4323  154.7378 164.0000 10.5000  5.35e+19
-33.7116  -71.9222  107.8359  280.9919  30.3375  0.1322  124.3315 172.0000  3.0000  2.91e+18
%--------------------------------------------------------------------------------------------------
% SEGMENT # 2: STRIKE = 18.7 deg DIP = 10 deg
% LEN = 350 km WID = 71 km
% depth to top: Z2top = 4.66 km
% coordinates of top-center:
% LAT = -34.7615117743998, LON = -73.7416689683824
% hypocenter on SEG # 1 : along-strike (X) = 37.5, down-dip (Z) = 26.625
% Nsbfs = 56 subfaults
%--------------------------------------------------------------------------------------------------
% LAT LON X==EW Y==NS Z SLIP RAKE TRUP RISE SF_MOMENT
%--------------------------------------------------------------------------------------------------
-36.1833  -74.1801  -98.5956    6.3291   6.2058  4.1210  107.6475  48.0000  0.0000  5.71e+19
-35.9702  -74.0904  -90.7622   30.1110   6.2058  4.3215  134.9567  36.0000  0.0000  5.99e+19
-35.7571  -74.0007  -82.8931   53.8854   6.2058  2.6999  139.1175  40.0000  9.0000  3.74e+19
-35.5440  -73.9110  -74.9751   77.6525   6.2058  4.3335   92.7834  44.0000  1.5000  6.00e+19
-35.3309  -73.8213  -67.0128  101.4123   6.2058  4.9374   93.9477  64.0000  4.5000  6.84e+19
-35.1178  -73.7316  -59.0066  125.1647   6.2058  5.4590   97.8479  80.0000  1.5000  7.56e+19
-34.9047  -73.6419  -50.9566  148.9096   6.2058  2.8393   95.1763  76.0000 10.5000  3.93e+19
-34.6916  -73.5522  -42.8676  172.6471   6.2058  0.0779   71.8833  84.0000  6.0000  1.08e+18
-34.4785  -73.4625  -34.7308  196.3771   6.2058  0.0407   70.7329  92.0000  1.5000  5.63e+17
-34.2654  -73.3728  -26.5555  220.0997   6.2058  0.0391   72.1364 112.0000  1.5000  5.42e+17
-34.0523  -73.2831  -18.3282  243.8148   6.2058  0.0371   72.2003 120.0000 10.5000  5.13e+17
-33.8392  -73.1934  -10.0675  267.5223   6.2058  0.0611   71.4040 124.0000  7.5000  8.46e+17
-33.6261  -73.1037   -1.7644  291.2222   6.2058  0.0756   70.7606 132.0000 10.5000  1.05e+18
-33.4129  -73.0141    6.5715  314.9258   6.2058  0.0612   71.5554 144.0000  1.5000  8.48e+17
-36.2337  -73.9948  -81.9131    0.8977   9.2881  6.2513   91.0186  48.0000  4.5000  8.66e+19
-36.0206  -73.9051  -74.0443   24.6642   9.2881  5.6905  119.7881  40.0000  6.0000  7.88e+19
-35.8075  -73.8154  -66.1264   48.4234   9.2881  7.7000  145.1587  52.0000 12.0000  1.07e+20
-35.5944  -73.7257  -58.1732   72.1751   9.2881  8.6551  116.1854  48.0000  9.0000  1.20e+20
-35.3813  -73.6360  -50.1714   95.9195   9.2881 11.1465  103.6269  60.0000 12.0000  1.54e+20
-35.1682  -73.5463  -42.1303  119.6565   9.2881 12.6741  117.0220  72.0000  3.0000  1.76e+20
-34.9551  -73.4566  -34.0364  143.3860   9.2881  9.7873  112.6451  72.0000  9.0000  1.36e+20
-34.7420  -73.3669  -25.9083  167.1080   9.2881  8.2465  123.7802  72.0000  9.0000  1.14e+20
-34.5289  -73.2772  -17.7325  190.8226   9.2881  7.9953  116.2880  92.0000  6.0000  1.11e+20
-34.3158  -73.1875   -9.5183  214.5296   9.2881  5.7315  126.1249 112.0000  1.5000  7.94e+19
-34.1027  -73.0978   -1.2569  238.2292   9.2881  0.0999   72.4532 120.0000  9.0000  1.38e+18
-33.8896  -73.0082    7.0332  261.9211   9.2881  0.0918   71.6881 128.0000  9.0000  1.27e+18
-33.6765  -72.9185   15.3794  285.6055   9.2881  0.0208   71.7729 132.0000 12.0000  2.88e+17
-33.4634  -72.8288   23.7675  309.2823   9.2881  0.1831   99.1366 144.0000  4.5000  2.54e+18
-36.2842  -73.8095  -65.2516   -4.5768  12.3703  4.9684  113.0315  24.0000 10.5000  8.75e+19
-36.0711  -73.7198  -57.3428   19.1744  12.3703  6.5361  109.7698  28.0000  3.0000  1.15e+20
-35.8580  -73.6301  -49.3896   42.9183  12.3703  6.6519  124.4132  32.0000  9.0000  1.17e+20
-35.6449  -73.5404  -41.3922   66.6547  12.3703  8.8180  118.4518  44.0000  9.0000  1.55e+20
-35.4318  -73.4507  -33.3508   90.3837  12.3703 14.3138  103.5219  52.0000 10.5000  2.52e+20
-35.2187  -73.3610  -25.2657  114.1052  12.3703 16.3244  113.8650  60.0000  4.5000  2.88e+20
-35.0056  -73.2713  -17.1417  137.8193  12.3703 16.8144  108.6317  68.0000  6.0000  2.96e+20
-34.7924  -73.1816   -8.9699  161.5370  12.3703 16.1243  109.5655  68.0000  1.5000  2.84e+20
-34.5793  -73.0919   -0.7550  185.2361  12.3703 14.3317   96.3931  80.0000  3.0000  2.52e+20
-34.3662  -73.0023    7.4935  208.9276  12.3703 12.4070   95.6711 100.0000 10.5000  2.19e+20
-34.1531  -72.9126   15.7892  232.6115  12.3703  2.6457  101.0362 120.0000  7.5000  4.66e+19
-33.9400  -72.8229   24.1271  256.2879  12.3703  1.7370   84.8696 124.0000  9.0000  3.06e+19
-33.7269  -72.7332   32.5118  279.9567  12.3703  0.9041  135.5455 132.0000 12.0000  1.59e+19
-33.5138  -72.6435   40.9337  303.6179  12.3703  0.0237  138.0370 148.0000 10.5000  4.17e+17
-36.3346  -73.6242  -48.6159  -10.0719  15.4526  5.3656  139.7118  12.0000  1.5000  9.45e+19
-36.1215  -73.5345  -40.6626   13.6640  15.4526  5.5962  116.3852  20.0000  7.5000  9.86e+19
-35.9084  -73.4448  -32.6695   37.3925  15.4526  3.7373  124.6089  28.0000  1.5000  6.58e+19
-35.6953  -73.3551  -24.6323   61.1135  15.4526  4.9010  133.1759  32.0000 10.5000  8.63e+19
-35.4822  -73.2654  -16.5513   84.8271  15.4526 11.6252  100.3359  52.0000  7.5000  2.05e+20
-35.2691  -73.1758   -8.4358  108.5332  15.4526 16.9582  116.4245  60.0000  4.5000  2.99e+20
-35.0560  -73.0861   -0.2724  132.2318  15.4526 16.2895  122.6051  64.0000  6.0000  2.87e+20
-34.8429  -72.9964    7.9386  155.9229  15.4526 14.2540  112.1542  80.0000 12.0000  2.51e+20
-34.6298  -72.9067   16.1880  179.6064  15.4526 12.6042  118.0709  72.0000  3.0000  2.22e+20
-34.4167  -72.8170   24.4892  203.2824  15.4526  8.0679  109.3127  76.0000 12.0000  1.42e+20
-34.2036  -72.7273   32.8237  226.9508  15.4526  1.7074  125.5437 108.0000  7.5000  3.01e+19
-33.9905  -72.6376   41.2049  250.6116  15.4526  1.4320   99.4126 124.0000  3.0000  2.52e+19
-33.7774  -72.5479   49.6235  274.2648  15.4526  2.3450  136.7264 144.0000  6.0000  4.13e+19
-33.5643  -72.4582   58.0839  297.9103  15.4526  0.0950   95.7748 156.0000  3.0000  1.67e+18
%--------------------------------------------------------------------------------------------------
% SEGMENT # 3: STRIKE = 18.7 deg DIP = 23.5 deg
% LEN = 350 km WID = 53.25 km
% depth to top: Z2top = 34.74 km
% coordinates of top-center:
% LAT = -35.1061937102391, LON = -72.4743519197046
% hypocenter on SEG # 1 : along-strike (X) = 37.5, down-dip (Z) = 26.625
% Nsbfs = 42 subfaults
%--------------------------------------------------------------------------------------------------
% LAT LON X==EW Y==NS Z SLIP RAKE TRUP RISE SF_MOMENT
%--------------------------------------------------------------------------------------------------
-36.5280  -72.9146   15.4810  -31.6428  38.2855 10.6865   91.9385  16.0000  9.0000  3.20e+20
-36.3149  -72.8248   23.5892   -7.9664  38.2855 13.5795  109.4861  12.0000 10.5000  4.07e+20
-36.1018  -72.7350   31.7458   15.7025  38.2855  2.9481  108.8203  20.0000  0.0000  8.83e+19
-35.8887  -72.6452   39.9414   39.3638  38.2855  0.5862  103.4852  28.0000  0.0000  1.76e+19
-35.6756  -72.5554   48.1849   63.0176  38.2855  3.2037   71.2410  36.0000  3.0000  9.60e+19
-35.4624  -72.4656   56.4671   86.6748  38.2855  6.6272  126.2589  48.0000  9.0000  1.99e+20
-35.2493  -72.3758   64.8012  110.3133  38.2855  6.8422  106.7618  72.0000  7.5000  2.05e+20
-35.0362  -72.2860   73.1688  133.9442  38.2855 11.3562  114.5809  68.0000  9.0000  3.40e+20
-34.8231  -72.1962   81.5835  157.5673  38.2855 10.9350  104.9041  84.0000  4.5000  3.28e+20
-34.6100  -72.1064   90.0357  181.1829  38.2855  4.2961   92.5136  88.0000  1.5000  1.29e+20
-34.3969  -72.0166   98.5300  204.7908  38.2855  3.6298  104.8478 104.0000 12.0000  1.09e+20
-34.1838  -71.9268  107.0659  228.3909  38.2855  6.6549  138.9937 124.0000  3.0000  1.99e+20
-33.9707  -71.8370  115.6480  251.9833  38.2855  4.9643  157.8830 160.0000 10.5000  1.49e+20
-33.7576  -71.7472  124.2667  275.5680  38.2855  0.0428   82.6800 176.0000  1.5000  1.28e+18
-36.5749  -72.7419   30.8930  -36.8990  45.3633  6.4925   96.2177  24.0000  4.5000  1.95e+20
-36.3618  -72.6521   39.0432  -13.2370  45.3633  9.7651  113.6104  16.0000  6.0000  2.93e+20
-36.1487  -72.5623   47.2326   10.4175  45.3633  4.0847  153.7122  24.0000  4.5000  1.22e+20
-35.9356  -72.4725   55.4700   34.0643  45.3633  1.3387  146.9030  40.0000 12.0000  4.01e+19
-35.7225  -72.3827   63.7461   57.7036  45.3633  0.7050   92.1100  40.0000  4.5000  2.11e+19
-35.5094  -72.2929   72.0697   81.3352  45.3633  4.4761   95.5885  52.0000  1.5000  1.34e+20
-35.2963  -72.2031   80.4316  104.9591  45.3633  2.3866  146.7741  68.0000  1.5000  7.15e+19
-35.0832  -72.1133   88.8360  128.5755  45.3633  5.8835  130.5969  68.0000 12.0000  1.76e+20
-34.8701  -72.0234   97.2963  152.1840  45.3633  8.0050  113.2867  76.0000  6.0000  2.40e+20
-34.6570  -71.9336  105.7851  175.7849  45.3633  4.2349   96.4618  80.0000  1.5000  1.27e+20
-34.4439  -71.8438  114.3157  199.3781  45.3633  2.9265  139.3516  92.0000  3.0000  8.77e+19
-34.2308  -71.7540  122.8925  222.9636  45.3633 10.3126  141.9533 108.0000  1.5000  3.09e+20
-34.0177  -71.6642  131.5061  246.5414  45.3633  4.2509  157.3371 156.0000  3.0000  1.27e+20
-33.8046  -71.5744  140.1608  270.1114  45.3633  0.1680  110.6492 172.0000  3.0000  5.04e+18
-36.6219  -72.5691   46.2906  -42.1938  52.4411  4.3295  120.3463  28.0000  6.0000  1.30e+20
-36.4088  -72.4793   54.4828  -18.5463  52.4411  3.9519  103.2711  32.0000  1.5000  1.18e+20
-36.1957  -72.3895   62.7097    5.0937  52.4411  1.0217   94.9010  36.0000 12.0000  3.06e+19
-35.9826  -72.2997   70.9843   28.7260  52.4411  1.7315  110.6010  44.0000 10.5000  5.19e+19
-35.7695  -72.2099   79.2976   52.3508  52.4411  1.2039   82.2898  44.0000  1.5000  3.61e+19
-35.5564  -72.1201   87.6582   75.9678  52.4411  2.0075   74.9873  52.0000 12.0000  6.02e+19
-35.3433  -72.0303   96.0570   99.5772  52.4411  0.9796   94.5302  60.0000  3.0000  2.94e+19
-35.1302  -71.9405  104.5027  123.1789  52.4411  3.2295  104.5017  76.0000  9.0000  9.68e+19
-34.9171  -71.8507  112.9861  146.7730  52.4411  4.9754  152.7641  92.0000  3.0000  1.49e+20
-34.7040  -71.7609  121.5113  170.3593  52.4411  1.0964  155.9462  88.0000  3.0000  3.29e+19
-34.4909  -71.6711  130.0829  193.9378  52.4411  0.2474  152.7010  96.0000  1.5000  7.41e+18
-34.2778  -71.5813  138.6914  217.5086  52.4411  4.9760  145.8189 116.0000 10.5000  1.49e+20
-34.0646  -71.4915  147.3414  241.0828  52.4411  1.8186  144.4535 144.0000 12.0000  5.45e+19
-33.8515  -71.4016  156.0414  264.6380  52.4411  0.0688  114.7581 168.0000  1.5000  2.06e+18
%--------------------------------------------------------------------------------------------------
% SEGMENT # 4: STRIKE = 8.7 deg DIP = 17.5 deg
% LEN = 300 km WID = 71 km
% depth to top: Z2top = 16.99 km
% coordinates of top-center:
% LAT = -37.7956734874351, LON = -73.875733125741
% hypocenter on SEG # 1 : along-strike (X) = 37.5, down-dip (Z) = 26.625
% Nsbfs = 48 subfaults
%--------------------------------------------------------------------------------------------------
% LAT LON X==EW Y==NS Z SLIP RAKE TRUP RISE SF_MOMENT
%--------------------------------------------------------------------------------------------------
-39.0354  -73.9694  -77.1007 -312.1174  19.6625  0.0881  123.0779 160.0000 10.5000  1.55e+18
-38.8130  -73.9271  -73.6455 -287.3554  19.6625  4.1916   77.7512 156.0000 12.0000  7.38e+19
-38.5907  -73.8848  -70.1625 -262.6060  19.6625  3.5855   71.8103 148.0000  1.5000  6.32e+19
-38.3683  -73.8425  -66.6650 -237.8471  19.6625  0.5706  125.8236 136.0000  7.5000  1.01e+19
-38.1459  -73.8002  -63.1399 -213.0898  19.6625  1.4841   69.6321 112.0000  0.0000  2.61e+19
-37.9235  -73.7579  -59.5962 -188.3341  19.6625  1.9068  121.2868  84.0000  0.0000  3.36e+19
-37.7011  -73.7155  -56.0120 -163.5799  19.6625  4.1266   92.6777  72.0000  4.5000  7.27e+19
-37.4787  -73.6732  -52.4225 -138.8274  19.6625  6.4054   92.6468  64.0000  9.0000  1.13e+20
-37.2563  -73.6309  -48.8059 -114.0765  19.6625  5.1549   85.6012  56.0000  4.5000  9.08e+19
-37.0339  -73.5886  -45.1712  -89.3272  19.6625  7.5001  123.9610  44.0000 12.0000  1.32e+20
-36.8115  -73.5463  -41.5096  -64.5796  19.6625 11.4107  106.6475  36.0000  3.0000  2.01e+20
-36.5891  -73.5040  -37.8301  -39.8335  19.6625 11.4747  109.9497  28.0000  1.5000  2.02e+20
-39.0585  -73.7822  -60.9047 -314.5496  25.0000  0.1143   66.6456 156.0000  1.5000  2.51e+18
-38.8361  -73.7399  -57.4009 -289.7947  25.0000  2.9272   60.8819 144.0000  3.0000  6.44e+19
-38.6137  -73.6975  -53.8695 -265.0413  25.0000  0.8107  135.1820 144.0000  7.5000  1.78e+19
-38.3913  -73.6552  -50.3150 -240.2896  25.0000  1.0053  132.7415 132.0000  6.0000  2.21e+19
-38.1689  -73.6129  -46.7462 -215.5395  25.0000  1.7848  147.5126 112.0000  6.0000  3.93e+19
-37.9465  -73.5706  -43.1501 -190.7909  25.0000  2.0813  132.9885  88.0000 12.0000  4.58e+19
-37.7241  -73.5283  -39.5313 -166.0440  25.0000  4.6113   86.8079  68.0000 12.0000  1.01e+20
-37.5017  -73.4860  -35.8898 -141.2987  25.0000  4.2352   80.4314  68.0000  1.5000  9.32e+19
-37.2793  -73.4436  -32.2169 -116.5550  25.0000  3.6800  105.3077  56.0000  7.5000  8.10e+19
-37.0569  -73.4013  -28.5348  -91.8129  25.0000  9.7544  132.4953  48.0000  9.0000  2.15e+20
-36.8345  -73.3590  -24.8305  -67.0726  25.0000 12.6905  114.9819  28.0000  4.5000  2.79e+20
-36.6122  -73.3167  -21.0995  -42.3449  25.0000 15.8599  103.7769  20.0000  3.0000  3.49e+20
-39.0815  -73.5949  -44.7188 -317.0027  30.3375  0.0003  142.9629 152.0000  1.5000  6.25e+15
-38.8591  -73.5526  -41.1621 -292.2549  30.3375  2.3127  114.0167 140.0000  4.5000  5.09e+19
-38.6367  -73.5103  -37.5866 -267.5087  30.3375  1.2723  134.6645 144.0000 10.5000  2.80e+19
-38.4143  -73.4680  -33.9924 -242.7642  30.3375  0.1254  110.9950 136.0000 10.5000  2.76e+18
-38.1920  -73.4257  -30.3667 -218.0323  30.3375  2.5572   90.9389 116.0000  3.0000  5.63e+19
-37.9696  -73.3833  -26.7139 -193.2910  30.3375  1.9898   64.9793  96.0000 10.5000  4.38e+19
-37.7472  -73.3410  -23.0517 -168.5513  30.3375  3.8986  101.6265  80.0000  7.5000  8.58e+19
-37.5248  -73.2987  -19.3625 -143.8133  30.3375  3.4953  125.1805  72.0000  1.5000  7.69e+19
-37.3024  -73.2564  -15.6554 -119.0769  30.3375  3.8183   89.9073  48.0000  9.0000  8.40e+19
-37.0800  -73.2141  -11.9172  -94.3421  30.3375  8.0360  120.4964  40.0000  6.0000  1.77e+20
-36.8576  -73.1718   -8.1657  -69.6090  30.3375 10.6860  101.6958  28.0000 12.0000  2.35e+20
-36.6352  -73.1294   -4.3833  -44.8776  30.3375 14.0553   98.2955  28.0000  4.5000  3.09e+20
-39.1046  -73.4077  -28.5431 -319.4989  35.6751  0.1275  141.4487 148.0000  1.5000  3.82e+18
-38.8822  -73.3654  -24.9377 -294.7582  35.6751  1.3524  144.6593 152.0000  7.5000  4.05e+19
-38.6598  -73.3230  -21.3093 -270.0193  35.6751  1.5425  148.3688 148.0000  3.0000  4.62e+19
-38.4374  -73.2807  -17.6625 -245.2819  35.6751  0.7843  102.6891 140.0000 10.5000  2.35e+19
-38.2150  -73.2384  -13.9931 -220.5462  35.6751  1.6657   69.9633 116.0000  3.0000  4.99e+19
-37.9926  -73.1961  -10.3010 -195.8121  35.6751  0.6880  108.6488 100.0000 12.0000  2.06e+19
-37.7702  -73.1538   -6.5866 -171.0797  35.6751  2.4978   91.9950  92.0000  9.0000  7.49e+19
-37.5478  -73.1115   -2.8542 -146.3490  35.6751  3.8491  141.9863  80.0000  7.5000  1.15e+20
-37.3254  -73.0691    0.9137 -121.6199  35.6751  2.9694  142.6638  56.0000  4.5000  8.90e+19
-37.1030  -73.0268    4.6904  -96.8925  35.6751  3.7193  125.5543  40.0000  1.5000  1.11e+20
-36.8806  -72.9845    8.4979  -72.1667  35.6751  4.3977   75.9162  36.0000  1.5000  1.32e+20
-36.6582  -72.9422   12.3185  -47.4427  35.6751  3.6038   97.4013  28.0000  1.5000  1.08e+20
%--------------------------------------------------------------------------------------------------
% SEGMENT # 5: STRIKE = 8.7 deg DIP = 10 deg
% LEN = 300 km WID = 71 km
% depth to top: Z2top = 4.88 km
% coordinates of top-center:
% LAT = -37.5882758966096, LON = -74.5957768421918
% hypocenter on SEG # 1 : along-strike (X) = 37.5, down-dip (Z) = 26.625
% Nsbfs = 48 subfaults
%--------------------------------------------------------------------------------------------------
% LAT LON X==EW Y==NS Z SLIP RAKE TRUP RISE SF_MOMENT
%--------------------------------------------------------------------------------------------------
-38.8280  -74.6892 -139.9450 -289.8389   6.4260  0.1207   79.1445 172.0000 12.0000  1.67e+18
-38.6056  -74.6470 -136.6791 -265.0500   6.4260  2.4538  136.3835 164.0000  7.5000  3.40e+19
-38.3832  -74.6048 -133.3850 -240.2624   6.4260  0.9225  146.7198 152.0000  4.5000  1.28e+19
-38.1608  -74.5626 -130.0757 -215.4765   6.4260  2.7177  148.6773 132.0000  1.5000  3.76e+19
-37.9384  -74.5203 -126.7296 -190.6918   6.4260  4.8299  149.3494 120.0000  3.0000  6.69e+19
-37.7160  -74.4781 -123.3687 -165.9088   6.4260  6.0748  149.3318 112.0000 12.0000  8.41e+19
-37.4936  -74.4359 -119.9842 -141.1273   6.4260  4.0589  148.4058  96.0000  0.0000  5.62e+19
-37.2712  -74.3937 -116.5764 -116.3473   6.4260  2.6431   85.9705  88.0000  0.0000  3.66e+19
-37.0488  -74.3515 -113.1498  -91.5689   6.4260  2.8642   66.2682  64.0000  3.0000  3.97e+19
-36.8264  -74.3093 -109.6957  -66.7919   6.4260  6.6321   61.7194  52.0000  4.5000  9.19e+19
-36.6040  -74.2671 -106.2185  -42.0165   6.4260  9.0524   61.4098  48.0000  1.5000  1.25e+20
-36.3817  -74.2249 -102.7183  -17.2538   6.4260  7.0499   63.2580  52.0000  1.5000  9.76e+19
-38.8518  -74.4963 -123.1935 -292.2180   9.5082  0.1355  141.8439 172.0000  1.5000  1.88e+18
-38.6294  -74.4541 -119.8733 -267.4361   9.5082  3.4683  129.0298 160.0000  3.0000  4.80e+19
-38.4070  -74.4119 -116.5382 -242.6559   9.5082  3.3357   60.2643 152.0000  1.5000  4.62e+19
-38.1846  -74.3697 -113.1706 -217.8770   9.5082  3.8311   97.2828 136.0000 10.5000  5.31e+19
-37.9622  -74.3275 -109.7839 -193.0997   9.5082  5.2500  119.1407 120.0000  3.0000  7.27e+19
-37.7398  -74.2853 -106.3781 -168.3240   9.5082  5.5106  148.0872 104.0000  7.5000  7.63e+19
-37.5174  -74.2431 -102.9402 -143.5496   9.5082  3.1312   69.2662  88.0000  6.0000  4.34e+19
-37.2950  -74.2009  -99.4880 -118.7770   9.5082  6.3269  104.3382  80.0000  9.0000  8.76e+19
-37.0726  -74.1587  -96.0082  -94.0058   9.5082  4.4965   74.9791  60.0000  1.5000  6.23e+19
-36.8502  -74.1165  -92.5100  -69.2362   9.5082  7.5613   72.3651  56.0000  1.5000  1.05e+20
-36.6278  -74.0743  -88.9845  -44.4682   9.5082 10.8924   62.0004  40.0000  4.5000  1.51e+20
-36.4055  -74.0321  -85.4361  -19.7128   9.5082  7.9929   65.9641  44.0000  7.5000  1.11e+20
-38.8756  -74.3035 -106.4610 -294.6311  12.5905  0.1301   76.5389 180.0000 10.5000  2.29e+18
-38.6532  -74.2613 -103.0910 -269.8565  12.5905  3.5165   62.2756 164.0000 12.0000  6.20e+19
-38.4308  -74.2191  -99.7017 -245.0834  12.5905  4.6959   64.2191 152.0000  1.5000  8.27e+19
-38.2084  -74.1769  -96.2890 -220.3118  12.5905  2.9249   89.7126 132.0000  4.5000  5.15e+19
-37.9860  -74.1347  -92.8528 -195.5417  12.5905  4.8004   76.5464 112.0000  1.5000  8.46e+19
-37.7636  -74.0925  -89.3935 -170.7732  12.5905  5.2916  127.5256 100.0000 12.0000  9.32e+19
-37.5412  -74.0503  -85.9109 -146.0063  12.5905  6.6459   87.7918  72.0000  6.0000  1.17e+20
-37.3188  -74.0081  -82.4054 -121.2409  12.5905 11.9568  126.9333  68.0000  4.5000  2.11e+20
-37.0964  -73.9659  -78.8769  -96.4770  12.5905  7.4594  114.1151  60.0000 12.0000  1.31e+20
-36.8740  -73.9236  -75.3212  -71.7147  12.5905  9.2030   97.2244  48.0000  9.0000  1.62e+20
-36.6516  -73.8814  -71.7473  -46.9541  12.5905  9.8853   84.2838  36.0000  6.0000  1.74e+20
-36.4292  -73.8392  -68.1552  -22.1950  12.5905  6.8903   96.8901  32.0000  3.0000  1.21e+20
-38.8994  -74.1106  -89.7261 -297.0781  15.6727  0.0522   78.1238 172.0000  3.0000  9.20e+17
-38.6770  -74.0684  -86.3105 -272.3107  15.6727  3.9914   78.0271 164.0000 12.0000  7.03e+19
-38.4546  -74.0262  -82.8714 -247.5449  15.6727  2.3933   80.7250 152.0000  1.5000  4.22e+19
-38.2322  -73.9840  -79.4091 -222.7805  15.6727  1.4632  116.5442 132.0000  1.5000  2.58e+19
-38.0098  -73.9418  -75.9235 -198.0178  15.6727  0.2739  139.9621 116.0000  3.0000  4.83e+18
-37.7874  -73.8996  -72.4104 -173.2566  15.6727  3.8022  148.5589 100.0000  1.5000  6.70e+19
-37.5650  -73.8574  -68.8832 -148.4970  15.6727  7.1475   75.9601  80.0000  3.0000  1.26e+20
-37.3426  -73.8152  -65.3287 -123.7389  15.6727 10.6342  100.3228  72.0000  1.5000  1.87e+20
-37.1202  -73.7730  -61.7515  -98.9825  15.6727  7.7309   94.6888  56.0000  3.0000  1.36e+20
-36.8978  -73.7308  -58.1516  -74.2276  15.6727  8.3131  107.8228  48.0000 10.5000  1.46e+20
-36.6754  -73.6886  -54.5337  -49.4744  15.6727  9.5839  108.7549  44.0000  1.5000  1.69e+20
-36.4530  -73.6464  -50.8890  -24.7228  15.6727  9.4311  111.8163  32.0000  1.5000  1.66e+20
%--------------------------------------------------------------------------------------------------
EOF
cat > sta.tmp << EOF
-74.0 -37.2 0.0
-74.1 -37.3 0.0
-74.2 -37.8 0.0
-74.6 -37.0 0.0
EOF
#echo lame 40e9 40e9 > haf.tmp
#o92util -fsp fsp.tmp -sta sta.tmp -disp disp.tmp -strain strain.tmp -haf haf.tmp
$BIN_DIR/o92util -fsp fsp.tmp -sta sta.tmp -disp disp.tmp -strain strain.tmp -prog || exit 1
cat > answer-dsp.tmp << EOF
  -74.000000000000000       -37.200000000000003        0.0000000000000000       -4.9271672098820289       -1.0506817728466533        1.1206996258297568
  -74.099999999999994       -37.299999999999997        0.0000000000000000       -4.8523384224063166      -0.65649401226543536        2.3548504927992888
  -74.200000000000003       -37.799999999999997        0.0000000000000000       -2.5602153415345903       -1.5273031615662676        1.1148488369609002
  -74.599999999999994       -37.000000000000000        0.0000000000000000      -0.19982527855966012       -8.5810895339092197E-002  0.12013011045535567
EOF
$TEST_BIN_DIR/test_values.sh disp.tmp answer-dsp.tmp 6 "o92util: fsp input, disp output" || exit 1
cat > answer-stn.tmp << EOF
  -74.000000000000000       -37.200000000000003        0.0000000000000000       -5.0212247921626235E-005  -1.0041693123323925E-005   2.0084647014977046E-005  -7.7575261686076063E-006  -7.4199974463866171E-020   6.2910278360338942E-020
  -74.099999999999994       -37.299999999999997        0.0000000000000000       -1.6314830959935751E-005   3.0990055226106301E-005  -4.8917414220178586E-006  -2.9829580051010603E-005   1.4649369895601918E-019  -2.2098677411407339E-021
  -74.200000000000003       -37.799999999999997        0.0000000000000000        3.0602840673828507E-005  -1.2638011817868725E-005  -5.9882762853182923E-006   1.4539080164378956E-005   1.0383682312629550E-019  -1.5807451811361982E-019
  -74.599999999999994       -37.000000000000000        0.0000000000000000       -4.5603682817282361E-005  -2.0929226097108183E-006   1.5898868475636763E-005   4.0882974756412985E-006   6.3945384446203221E-020  -1.7835596490646303E-020
EOF
$TEST_BIN_DIR/test_values.sh strain.tmp answer-stn.tmp 9 "o92util: fsp input, strain output" || exit 1
if [ "$IS_O92UTIL_PARALLEL" == "Y" ]
then
    echo "----------"
    echo "Test #6-parallel"
    echo "----------"
    $BIN_DIR/o92util -fsp fsp.tmp -sta sta.tmp -disp disp.tmp -strain strain.tmp -parallel || exit 1
    $TEST_BIN_DIR/test_values.sh disp.tmp answer-dsp.tmp 6 "o92util -parallel: fsp input, disp output" || exit 1
    $TEST_BIN_DIR/test_values.sh strain.tmp answer-stn.tmp 9 "o92util-parallel: fsp input, strain output" || exit 1
fi



echo "----------------------------------------------------------"
echo "Test #7: Stress tensor output"
echo "----------"
# Stress output, half-space parameters
#echo lame 45e9 30e9 > haf.tmp
#o92util -fsp fsp.tmp -sta sta.tmp -haf haf.tmp -stress stress.tmp
echo lame 45e9 shear 30e9 > haf.tmp
$BIN_DIR/o92util -fsp fsp.tmp -sta sta.tmp -haf haf.tmp -stress stress.tmp || exit 1
cat > answer.tmp << EOF
  -74.000000000000000       -37.200000000000003        0.0000000000000000       -4623490.3260502396       -2187755.6174448822       -1.5059486031532288E-006  -436357.11541625799        3.4510474554539409E-009  -3.6547700208579752E-009
  -74.099999999999994       -37.299999999999997        0.0000000000000000       -682949.32409030583        2132304.6958643897        4.6137720346450806E-006  -1765224.1957737862       -9.6188382193551955E-009   6.2938130715826246E-010
  -74.200000000000003       -37.799999999999997        0.0000000000000000        2302534.4051554669       -262744.72447106004       -2.1062442101538181E-006   901899.78029758832        6.2735070947345542E-009  -2.9571365883271950E-009
  -74.599999999999994       -37.000000000000000        0.0000000000000000       -3945444.8481556000       -1334366.6268596614       -3.1781382858753204E-006   251290.02888417014        2.8638910509231282E-009  -3.7081728076987578E-009
EOF
$TEST_BIN_DIR/test_values.sh stress.tmp answer.tmp 9 "o92util: fsp input, stress output" -zero 1e-4 || exit 1
if [ "$IS_O92UTIL_PARALLEL" == "Y" ]
then
    echo "----------"
    echo "Test #7-parallel"
    echo "----------"
    $BIN_DIR/o92util -fsp fsp.tmp -sta sta.tmp -haf haf.tmp -stress stress.tmp -parallel || exit 1
    $TEST_BIN_DIR/test_values.sh stress.tmp answer.tmp 9 "o92util -parallel: fsp input, stress output" -zero 1e-4 || exit 1
fi


echo "----------------------------------------------------------"
echo "Test #8: Maximum shear stress output"
echo "----------"
# Maximum shear stress output
#echo lame 45e9 30e9 > haf.tmp
#o92util -fsp fsp.tmp -sta sta.tmp -haf haf.tmp -estress estress.tmp
echo "lame 45e9 shear 30e9" > haf.tmp
$BIN_DIR/o92util -fsp fsp.tmp -sta sta.tmp -haf haf.tmp -estress estress.tmp || exit 1
cat > answer.tmp << EOF
-74.000000000000000       -37.200000000000003        0.0000000000000000        2353656.2408470074
-74.099999999999994       -37.299999999999997        0.0000000000000000        2296188.7647509635
-74.200000000000003       -37.799999999999997        0.0000000000000000        1674907.7473247214
-74.599999999999994       -37.000000000000000        0.0000000000000000        2022526.427274003
EOF
$TEST_BIN_DIR/test_values.sh estress.tmp answer.tmp 4 "o92util: fsp input, estress output" || exit 1


echo "----------------------------------------------------------"
echo "Test #9: Normal traction output"
echo "----------"
# Normal traction
echo "35 45 -90 0.5" > trg.tmp
#echo lame 20e9 20e9 > haf.tmp
#o92util -fsp fsp.tmp -sta sta.tmp -haf haf.tmp -trg trg.tmp -normal normal.tmp
echo "poisson 0.25 shear 20e9" > haf.tmp
$BIN_DIR/o92util -fsp fsp.tmp -sta sta.tmp -haf haf.tmp -trg trg.tmp -normal normal.tmp || exit 1
cat > answer.tmp << EOF
  -74.000000000000000       -37.200000000000003        0.0000000000000000       -995829.93792141357
  -74.099999999999994       -37.299999999999997        0.0000000000000000        643407.55667240557
  -74.200000000000003       -37.799999999999997        0.0000000000000000        174060.91306377898
  -74.599999999999994       -37.000000000000000        0.0000000000000000       -1020593.8475971021
EOF
$TEST_BIN_DIR/test_values.sh normal.tmp answer.tmp 4 "o92util: fsp input, normal output" || exit 1


echo "----------------------------------------------------------"
echo "Test #10: Shear traction output"
echo "----------"
# Shear traction
echo "35 25 -90 0.5" > trg.tmp
#echo lame 20e9 20e9 > haf.tmp
#o92util -fsp fsp.tmp -sta sta.tmp -haf haf.tmp -trg trg.tmp -shear shear.tmp
#o92util -fsp fsp.tmp -sta sta.tmp -haf haf.tmp -trg trg.tmp -shearmax shearmax.tmp
echo "poisson 0.25 shear 20e9" > haf.tmp
$BIN_DIR/o92util -fsp fsp.tmp -sta sta.tmp -haf haf.tmp -trg trg.tmp -shear shear.tmp || exit 1
cat > answer.tmp << EOF
  -74.000000000000000       -37.200000000000003        0.0000000000000000       -762849.99023592379        845205.24650152226
  -74.099999999999994       -37.299999999999997        0.0000000000000000        492878.78344786272        737186.82118636766
  -74.200000000000003       -37.799999999999997        0.0000000000000000        133338.39521664736        447818.76753149269
  -74.599999999999994       -37.000000000000000        0.0000000000000000       -781820.24563190748        845515.26320393407
EOF
$TEST_BIN_DIR/test_values.sh shear.tmp answer.tmp 5 "o92util: fsp input, shear output" || exit 1


echo "----------------------------------------------------------"
echo "Test #11: Coulomb stress output"
echo "----------"
# Coulomb stress change
echo "-17 15 106 0.5" > trg.tmp
#echo lame 45e9 42e9 > haf.tmp
#o92util -fsp fsp.tmp -sta sta.tmp -trg trg.tmp -haf haf.tmp -coul coul.tmp
echo "lame 45e9 shear 42e9" > haf.tmp
$BIN_DIR/o92util -fsp fsp.tmp -sta sta.tmp -trg trg.tmp -haf haf.tmp -coul coul.tmp || exit 1
cat > answer.tmp << EOF
  -74.000000000000000       -37.200000000000003        0.0000000000000000        1225836.8941970295
  -74.099999999999994       -37.299999999999997        0.0000000000000000        485816.35736134095
  -74.200000000000003       -37.799999999999997        0.0000000000000000       -718998.82505537570
  -74.599999999999994       -37.000000000000000        0.0000000000000000        882742.06208263908
EOF
$TEST_BIN_DIR/test_values.sh coul.tmp answer.tmp 4 "o92util: fsp input, coulomb output" || exit 1


echo "----------------------------------------------------------"
echo "Test #12: Target fault geometry test"
echo "----------"
# Target fault geometry
cat > trg.tmp << EOF
-17 15 106 0.5
-27 25 108 0.5
17 35 146 0.2
7 45 96 0.3
EOF
#echo lame 45e9 42e9 > haf.tmp
#o92util -fsp fsp.tmp -sta sta.tmp -trg trg.tmp -haf haf.tmp -coul coul.tmp
echo "lame 45e9 shear 42e9" > haf.tmp
$BIN_DIR/o92util -fsp fsp.tmp -sta sta.tmp -trg trg.tmp -haf haf.tmp -coul coul.tmp || exit 1
cat > answer.tmp << EOF
  -74.000000000000000       -37.200000000000003        0.0000000000000000        1225836.8941970295
  -74.099999999999994       -37.299999999999997        0.0000000000000000        576938.41842525115
  -74.200000000000003       -37.799999999999997        0.0000000000000000       -1379993.4693210640
  -74.599999999999994       -37.000000000000000        0.0000000000000000        1832340.3180295168
EOF
$TEST_BIN_DIR/test_values.sh coul.tmp answer.tmp 4 "o92util: fsp input, coulomb output, multiple target geometries" || exit 1


echo "----------------------------------------------------------"
echo "Side Test: Target fault geometry error message"
echo "----------"
cat > trg.tmp << EOF
1 2 3 4
9 2 3 4
EOF
$BIN_DIR/o92util -fsp fsp.tmp -sta sta.tmp -trg trg.tmp -haf haf.tmp -coul coul.tmp 2>&1 |\
    sed -n -e "1p" |\
    awk '{
        if(/read_targets/){
            print "target fault error message works"
        }else{
            print "target fault error message does not work"
        }
    }'


echo "----------------------------------------------------------"
echo "Test #13: Cartesian coordinate test"
echo "----------"
# Cartesian coordinates
cat > sta.tmp << EOF
-10 -10 0
  5 -15 0
 15  15 0
 -5   5 0
EOF
cat > flt.tmp << EOF
1 -1 15 13 85 174 1 11 20
EOF
#echo lame 40e9 40e9 > haf.tmp
#o92util -flt flt.tmp -sta sta.tmp -haf haf.tmp -disp disp.tmp -xy
$BIN_DIR/o92util -flt flt.tmp -sta sta.tmp -disp disp.tmp -xy || exit 1
cat > answer.tmp << EOF
  -10.000000000000000       -10.000000000000000        0.0000000000000000        3.2670517217273716E-002   2.2127722330856248E-002  -2.7147705233220441E-002
   5.0000000000000000       -15.000000000000000        0.0000000000000000        2.0294966584747873E-002  -4.2637709325634689E-002   3.6785032026075110E-002
   15.000000000000000        15.000000000000000        0.0000000000000000       -2.9750663026788790E-002  -2.4120472271095324E-002  -1.8083068822985059E-002
  -5.0000000000000000        5.0000000000000000        0.0000000000000000       -1.6571158547297737E-003   1.9662832850302875E-002   2.6951578535502809E-003
EOF
$TEST_BIN_DIR/test_values.sh disp.tmp answer.tmp 6 "o92util: flt input, cartesian coordinates" || exit 1

# Half-space parameters are checked implicitly in other tests


echo "----------------------------------------------------------"
echo "Test #14: Automatic station test"
echo "----------"
# Test auto stations
echo "0 0 10 40 20 80 1 6 4" > flt.tmp
$BIN_DIR/o92util -flt flt.tmp -auto 0 10 -disp disp.tmp || exit 1
rm o92util_auto_lims.dat


echo "----------------------------------------------------------"
echo "Test #15: Tensile source, displacement output"
echo "----------"
# Station coordinates
cat > sta.tmp << EOF
36.2 48.2 0.0
36.1 48.4 0.0
36.5 48.1 0.0
36.4 47.8 0.0
EOF
# Tensile source
echo "36.3 48.2 15 45 90 0.5 8.8 16.3" > tns.tmp
# Half-space elasticity
echo "lame 40e9 40e9" > haf.tmp
$BIN_DIR/o92util -flt flt.tmp -sta sta.tmp -haf haf.tmp -disp disp.tmp || exit 1
cat > answer.tmp << EOF
   36.200000000000003        48.200000000000003        0.0000000000000000        4.8211922140861619E-009  -9.2962362137340984E-009  -1.2318530148426677E-008
   36.100000000000001        48.399999999999999        0.0000000000000000        4.8476427280200898E-009  -9.4384305304864179E-009  -1.2210717511036504E-008
   36.500000000000000        48.100000000000001        0.0000000000000000        4.7610847480744825E-009  -9.0788986058960397E-009  -1.2363592203856339E-008
   36.399999999999999        47.799999999999997        0.0000000000000000        4.7670269964526054E-009  -9.0097626356377033E-009  -1.2533562505917477E-008
EOF
$TEST_BIN_DIR/test_values.sh disp.tmp answer.tmp 6 "o92util: tns input, displacement output" || exit 1


echo "----------------------------------------------------------"
echo "Test #16a: Magnitude file input, displacement and strain output (ignore commented/blank lines)"
echo "----------"
# Magnitude file input, displacement and strain output
echo 48.7 49.1 11.2 25 18 82 6.3 > mag.tmp
echo "#" >> mag.tmp
cat > sta.tmp << EOF
48.3 48.3 0.0
49.3 48.3 0.0
49.3 49.3 1.0
48.3 49.3 0.0
#
>

EOF
#echo lame 40e9 40e9 > haf.tmp
#o92util -mag mag.tmp -sta sta.tmp -disp disp.tmp -strain strain.tmp -haf haf.tmp
$BIN_DIR/o92util -mag mag.tmp -sta sta.tmp -disp disp.tmp -strain strain.tmp || exit 1
cat > answer.tmp << EOF
   48.299999999999997        48.299999999999997        0.0000000000000000       -3.5393395949412781E-005   1.1401656392254210E-004  -1.8591757683774509E-004
   49.299999999999997        48.299999999999997        0.0000000000000000       -6.0366539320161035E-004   8.5017095587964619E-004  -5.4974448880161075E-005
   49.299999999999997        49.299999999999997        1.0000000000000000       -2.2342352518426533E-003  -5.1199102694690852E-004  -7.2681239339385218E-004
   48.299999999999997        49.299999999999997        0.0000000000000000       -2.5795762306003234E-004   4.6761160715508103E-004   9.4958413409363535E-004
EOF
$TEST_BIN_DIR/test_values.sh disp.tmp answer.tmp 6 "o92util: mag input, disp output" || exit 1
cat > answer.tmp << EOF
   48.299999999999997        48.299999999999997        0.0000000000000000       -1.7677565613925514E-009  -4.5730167607966796E-010   7.4168607916545093E-010   5.2348281363135863E-009  -4.9774150502567332E-022   5.4353748318236034E-023
   49.299999999999997        48.299999999999997        0.0000000000000000       -5.6382245390818721E-009   1.9856262638886188E-008  -4.7393460332678656E-009  -1.0745428070901282E-008   2.9531944160633786E-023  -1.3826797709394983E-022
   49.299999999999997        49.299999999999997        1.0000000000000000        2.5303814304227497E-008   1.6806606344780625E-008  -1.3992244060995743E-008   9.1209737495935997E-008  -2.8071071253434435E-009  -2.3400862804067349E-009
   48.299999999999997        49.299999999999997        0.0000000000000000       -1.3834166113696379E-007  -3.1687688802198963E-008   5.6676449979720921E-008   1.2827594279523781E-007  -7.3226223485018587E-023  -1.1005951722697728E-022
EOF
$TEST_BIN_DIR/test_values.sh strain.tmp answer.tmp 9 "o92util: mag input, strain output" || exit 1



echo "----------------------------------------------------------"
echo "Test #16b: Fault file input, displacement and strain output (ignore commented/blank lines)"
echo "----------"
# Fault file input, displacement and strain output
echo 48.7 49.1 11.2 25 76 -132 1.5 4.9 6.4 > flt.tmp
echo "#" >> flt.tmp
cat > sta.tmp << EOF
#

48.3 48.3 0.0
49.3 48.3 0.0
49.3 49.3 1.0
48.3 49.3 0.0
EOF
#echo lame 40e9 40e9 > haf.tmp
#o92util -flt flt.tmp -sta sta.tmp -disp disp.tmp -strain strain.tmp -haf haf.tmp
$BIN_DIR/o92util -flt flt.tmp -sta sta.tmp -disp disp.tmp -strain strain.tmp || exit 1
cat > answer.tmp << EOF
   48.299999999999997        48.299999999999997        0.0000000000000000        1.5805317427851058E-004  -2.3604614842163930E-004   2.8040220357723848E-005
   49.299999999999997        48.299999999999997        0.0000000000000000        3.2644282656529915E-004  -6.3753967941883641E-004  -1.2309484389809238E-004
   49.299999999999997        49.299999999999997        1.0000000000000000       -2.7215642253313444E-003  -1.4000563159753576E-003  -1.0790382873926448E-005
   48.299999999999997        49.299999999999997        0.0000000000000000       -4.2676513197687496E-003   4.2357021267820094E-003   1.1564991638417050E-003
EOF
$TEST_BIN_DIR/test_values.sh disp.tmp answer.tmp 6 "o92util: flt input, disp output" || exit 1
cat > answer.tmp << EOF
   48.299999999999997        48.299999999999997        0.0000000000000000       -7.2303940702735573E-010  -9.6191340134039561E-010   5.6165093629310700E-010  -4.6093093922382619E-009  -2.7635669853291311E-021  -1.7160754588179454E-022
   49.299999999999997        48.299999999999997        0.0000000000000000       -5.8230608503956411E-010  -9.4935754289783330E-009   3.3586271713384775E-009   6.8667356059719260E-009  -3.7424622145359124E-022  -4.4121151653933028E-022
   49.299999999999997        49.299999999999997        1.0000000000000000        9.3905926851187105E-008   5.4253342737373626E-009  -3.3030337472570604E-008   7.3565880355188549E-008  -4.6609348128684193E-009  -2.5210307488185848E-009
   48.299999999999997        49.299999999999997        0.0000000000000000       -1.9890388895262303E-007   1.0217557547380974E-008   6.2895443801748052E-008   2.0072000061532723E-007  -4.0482339315170810E-022  -1.6352718120662996E-022
EOF
$TEST_BIN_DIR/test_values.sh strain.tmp answer.tmp 9 "o92util: flt input, strain output" || exit 1


