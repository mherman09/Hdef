#!/bin/bash

BIN_DIR=`./define_bin_dir.sh`

$BIN_DIR/grid -x 0 360 -dx 1 | awk '{print 30,0,$1*111.19,110}' | $BIN_DIR/distaz2lola -f stdin > lola.tmp
$BIN_DIR/grid -x 0 360 -dx 1 | awk '{print 30,0,$1*111.19,200}' | $BIN_DIR/distaz2lola -f stdin > lola3.tmp
$BIN_DIR/grid -x 0 360 -dx 1 | awk '{print 30,0,$1*111.19,90}' | $BIN_DIR/distaz2lola -f stdin > lola2.tmp
RADIUS=6371
$BIN_DIR/stereo_project -f lola.tmp  -geo2xy -lon0 0 -lat0 -90 -radius $RADIUS > stereo.tmp
$BIN_DIR/stereo_project -f lola2.tmp -geo2xy -lon0 0 -lat0 -90 -radius $RADIUS > stereo2.tmp
$BIN_DIR/stereo_project -f lola3.tmp -geo2xy -lon0 0 -lat0 -90 -radius $RADIUS > stereo3.tmp
cat > answer.tmp << EOF
   6370.9999999999991        11034.895695021318
   6202.4495244789050        10892.612647667920
   6037.4217047314132        10751.635027031394
   5875.7969770536374        10611.940557931601
   5717.4607890883499        10473.506713899791
   5562.3033499944459        10336.310782248325
   5410.2193947175765        10200.329922030993
   5261.1079614908449        10065.541215589172
   5114.8721817512960        9931.9217143105197
   4971.4190817110039        9799.4484791652503
   4830.6593948711534        9668.0986165296490
   4692.5073848138809        9537.8493097567880
   4556.8806776497158        9408.6778469095643
   4423.7001035390022        9280.5616450309553
   4292.8895467431266        9153.4782712900924
   4164.3758036965937        9027.4054613101398
   4038.0884486237296        8902.3211349544545
   3913.9597062542857        8778.2034098210024
   3791.9243312207768        8655.0306126710821
   3671.9194937469297        8532.7812889967281
   3553.8846712614049        8411.4342109117297
   3437.7615455941163        8290.9683835335145
   3323.4939054340393        8171.3630500072613
   3211.0275537475159        8052.5976953091586
   3100.3102198749225        7934.6520489527647
   2991.2914760410326        7817.5060867105431
   2883.9226580308637        7701.1400314520988
   2778.1567897980553        7585.5343531908793
   2673.9485117871100        7470.6697684223736
   2571.2540127642233        7356.5272388289814
   2470.0309649638489        7243.0879694194346
   2370.2384623698445        7130.3334061642090
   2271.8369619609530        7018.2452331824097
   2174.7882277605240        6906.8053695302751
   2079.0552775399951        6795.9959656365590
   1984.6023320344962        6685.7993994256267
   1891.3947665373653        6576.1982721650829
   1799.3990647481651        6467.1754040711576
   1708.5827747560763        6358.7138297016108
   1618.9144670475000        6250.7967931631338
   1530.3636944330317        6143.4077431572387
   1442.9009537950933        6036.5303278863303
   1356.4976495630940        5930.1483898392607
   1271.1260588283408        5824.2459604736969
   1186.7592980158893        5718.8072548106666
   1103.3712910351894        5613.8166659550179
   1020.9367388357755        5509.2587595539098
   939.43109029837478        5405.1182682040680
   858.83051439568851        5301.3800858172281
   779.11187356071878        5198.0292619520451
   700.25269820396875        5095.0509961195894
   622.23116232403197        4992.4306320686810
   545.02606015915069        4890.1536520563113
   468.61678383015146        4788.2056711076903
   392.98330192785522        4686.5724312695647
   318.10613900060554        4585.2397958599322
   243.96635589992198        4484.1937437165261
   170.54553094455832        4383.4203634459209
   97.825741865332915        4282.9058476745640
   25.789548495140856        4182.6364873025987
  -45.580023829594886        4082.5986657608100
  -116.29950018796646        3982.7788532706950
  -186.38497134436577        3883.1636011072646
  -255.85210839768541        3783.7395358637682
  -324.71617683710485        3684.4933537172892
  -392.99205003015669        3585.4118146938276
  -460.69422216748904        3486.4817369311709
  -527.83682068741371        3387.6899909376116
  -594.43361820216069        3289.0234938443728
  -660.49804394652108        3190.4692036492338
  -726.04319476864384        3092.0141134487872
  -791.08184568148556        2993.6452456564366
  -855.62645999265453        2895.3496462030557
  -919.68919902929429        2797.1143787170781
  -983.28193147385514        2698.9265186805601
  -1046.4162423256996        2600.7731475575870
  -1109.1034415027329        2502.6413468912183
  -1171.3545720964109        2404.5181923649789
  -1233.1804182928136        2306.3907478247211
  -1294.5915129717364        2208.2460592565712
  -1355.5981449950350        2110.0711487164012
  -1416.2103661949036        2011.8530082061729
  -1476.4379980720814        1913.5785934922765
  -1536.2906382133924        1815.2348178608638
  -1595.7776664374526        1716.8085458049350
  -1654.9082506768750        1618.2865866377458
  -1713.6913526046603        1519.6556880270380
  -1772.1357330120743        1420.9025294441935
  -1830.2499569446809        1322.0137155224138
  -1888.0423986028281        1222.9757693176703
  -1945.5212460123121        1123.7751254660620
  -2002.6996339062259        1024.3891773033081
  -2059.5802097771871        924.81307213383172
  -2116.1706309727565        825.03293338222170
  -2172.4783850894996        725.03476746668093
  -2228.4605262503505        624.89470004600287
  -2284.2249857667280        524.41822156344813
  -2339.7282511813564        423.68097070978467
  -2394.9771651295118        322.66840981563934
  -2449.9784164389093        221.36584531433482
  -2504.7385427223444        119.75841945226423
  -2559.2639327746128        17.831101807870326
  -2613.5608287743567       -84.431319390694057
  -2667.6353282908826       -187.04424615948827
  -2721.4933860955980       -290.02327987495431
  -2775.0926645987151       -393.29110377587892
  -2828.5353217856809       -497.04963481531769
  -2881.7785550360818       -601.22235310001327
  -2934.8277622227197       -705.82575323383503
  -2987.6882045024317       -810.87657849092648
  -3040.3650069222026       -916.39183151479824
  -3092.8631588141889       -1022.3887853277075
  -3145.1875139752929       -1128.8849946650175
  -3197.3427906263678       -1235.8983076500565
  -3249.3335711455152       -1343.4468778255168
  -3301.1643015693262       -1451.5491765582258
  -3352.7928892466521       -1560.1260137654883
  -3404.3164427608231       -1669.3919786075387
  -3455.6924540607442       -1779.2691053711349
  -3506.9248140611867       -1889.7772685258115
  -3558.0172710977731       -2000.9367286195802
  -3608.9734288666632       -2112.7681473215312
  -3659.7967440681841       -2225.2926029787914
  -3710.4905237418116       -2338.5316067120252
  -3761.0579222788265       -2452.5071190746899
  -3811.5019380978160       -2567.2415673023529
  -3861.7802083858387       -2682.6536234139835
  -3911.9859162213629       -2798.9744469591092
  -3962.0762599359441       -2916.1244483385772
  -4012.0535736433849       -3034.1281063137144
  -4061.9200132070951       -3153.0104624252963
  -4111.6775505117130       -3272.7971424139055
  -4161.3279672567278       -3393.5143784550028
  -4210.8728482452707       -3515.1890322475265
  -4260.3135741395135       -3637.8486189966889
  -4309.6069911454288       -3761.4096521352049
  -4358.8427840349441       -3886.1234397478265
  -4407.9772573195969       -4011.9088541431324
  -4457.0108910750450       -4138.7962831113991
  -4505.9439158590731       -4266.8169028253797
  -4554.7763015336932       -4396.0027081661192
  -4603.5077452836440       -4526.3865442925808
  -4652.1376587803779       -4658.0021395158801
  -4700.6651544367141       -4790.8841395422423
  -4749.0890306933470       -4925.0681431520170
  -4797.3643519553771       -5060.4682540211597
  -4845.5761462217497       -5197.3658061313499
  -4893.6786717429168       -5335.6782211749660
  -4941.6693026078801       -5475.4452972857625
  -4989.5450084708800       -5616.7079881875816
  -5037.3023325189015       -5759.5084491179023
  -5084.9373679126393       -5903.8900847710711
  -5132.4457325948561       -6049.8975993634604
  -5179.8225423515123       -6197.5770489283532
  -5227.0623820023802       -6346.9758959540641
  -5274.1592745878315       -6498.1430664850523
  -5321.0644988229524       -6650.9906000116653
  -5367.8552965423687       -6805.8456448388215
  -5414.4815117404378       -6962.6251342557771
  -5460.9345675079649       -7121.3844717887068
  -5507.2051356186539       -7282.1808515695375
  -5553.2830902385904       -7445.0733331152433
  -5599.1574583467172       -7610.1229196106960
  -5644.8163666179062       -7777.3926398774947
  -5690.2469844996276       -7946.9476342210801
  -5735.3949392328232       -8118.6995736343106
  -5780.3265844744274       -8293.0272266378179
  -5824.9850866820216       -8469.8490986258585
  -5869.3531314322672       -8649.2397168951466
  -5913.4120943199432       -8831.2762150072031
  -5957.1419541333962       -9016.0384465445131
  -6000.5211995795171       -9203.6091044044842
  -6043.5267290387919       -9394.0738459191889
  -6086.1337427851458       -9587.5214241027916
  -6128.3156270551217       -9784.0438253431112
  -6170.0065167507546       -9983.5553807075848
  -6211.2508612549909       -10186.514064836281
  -6251.9780852674812       -10392.844318109792
  -6292.1529739830457       -10602.652574574966
  -6331.7377710918918       -10816.049298733869
  -6370.6919975435821       -11033.149169378437
  -6408.9722559710435       -11254.071272505011
  -6446.5320195342028       -11478.939303743397
  -6483.3214038257993       -11707.881780748126
  -6519.2869203527989       -11941.032266010090
  -6554.3400733143126       -12178.314028264203
  -6588.4824945376058       -12420.298471292461
  -6621.6162425916482       -12666.924135650899
  -6653.6705230506423       -12918.347210607217
  -6684.5693659547014       -13174.730216880320
  -6714.2312284872287       -13436.242301869106
  -6742.5685639085214       -13703.059548560050
  -6769.4873536116665       -13975.365298520963
  -6794.8865988521002       -14253.350489347687
  -6818.6577683539244       -14537.214006875045
  -6840.6652103360921       -14826.899509047891
  -6860.8231889684712       -15123.144215231030
  -6878.9761520508328       -15425.915136453794
  -6894.9788857176545       -15735.446766451898
  -6908.6750582299219       -16051.983533964692
  -6919.8962984329364       -16375.780244388181
  -6928.4611900668888       -16707.102534910762
  -6934.1741736033173       -17046.227342019578
  -6936.8243464078059       -17393.443379867003
  -6936.1841510634667       -17749.051627504668
  -6932.0079406209024       -18113.365822411590
  -6924.0393742270135       -18486.373054346197
  -6911.9776460759640       -18869.085284731835
  -6895.5182509726556       -19261.525854569398
  -6874.3259357327915       -19664.064449456640
  -6848.0378567981752       -20077.085927507051
  -6816.2610958992509       -20500.990746118674
  -6778.5699332317126       -20936.195347512086
  -6734.5028533648556       -21383.132489098407
  -6683.5592566151472       -21842.251501842307
  -6625.2518371847946       -22313.588380278950
  -6558.8861307117759       -22798.474105960166
  -6483.8702498441999       -23296.989728546687
  -6399.5074230848049       -23809.651200772569
  -6305.0397851291318       -24336.990390830717
  -6199.6425851213899       -24879.554309608415
  -6082.4178242763210       -25437.904005547494
  -5952.3872698633004       -26012.613056122889
  -5808.4847893754495       -26604.265571470005
  -5649.5479459917233       -27213.453609798937
  -5474.3087944702356       -27840.773885500625
  -5281.5656966160914       -28486.234056866811
  -5069.4627917824319       -29151.588218676534
  -4836.5169188136342       -29836.845504392197
  -4580.9280832732175       -30542.568694436712
  -4300.7307051851394       -31269.292223367422
  -3993.7784525836041       -32017.510608648983
  -3657.7279785686505       -32787.664463731831
  -3290.0215961292297       -33580.123657421362
  -2887.8689725125705       -34395.167111148541
  -2448.6411618571101       -35232.195000093088
  -1968.2364408080120       -36092.734134215527
  -1443.4279247468355       -36975.883446981272
  -870.29945147417357       -37881.266619370275
  -244.60476080082807       -38808.241305109594
   438.24948546010097       -39755.843253965904
   1183.2175924467335       -40722.721053627647
   1995.6240096441281       -41707.060326908257
   2881.1657050365438       -42706.496232643003
   3845.9050742273798       -43718.013211978672
   4895.2650442357044       -44736.911629962466
   6037.8461381945872       -45760.357023131124
   7279.7097236916079       -46781.729499373607
   8627.9856309895040       -47794.134427889308
   10089.845720078527       -48789.323516803139
   11672.339937947349       -49757.523854725761
   13382.181438994834       -50687.267703493533
   15225.472250273056       -51565.232991221288
   17207.361623019002       -52376.108342004685
   19331.631073953373       -53102.501017713781
   21600.203672378466       -53724.911108445522
   24010.347696135173       -54221.416645273304
   26562.862180820212       -54569.548344531642
   29248.395340171512       -54743.933177571613
   32055.333244213271       -54718.769285251386
   34967.087432812950       -54468.090876885042
   37961.611344218130       -53966.772987272641
   41011.124294931062       -53191.759768025193
   44082.133419377496       -52123.476201625788
   47135.839111948328       -50747.346271200229
   50126.338074502397       -49056.966272158119
   53012.672118696952       -47049.080970792551
   55744.387117338636       -44733.738440939043
   58274.523988237524       -42129.033901956478
   60559.204889986286       -39262.414693062623
   62559.923822424164       -36169.927077891713
   64245.583915931158       -32894.802196498407
   65594.065350886129       -29485.489045369253
   66593.161359819016       -25993.319188991401
   67240.801456451169       -22470.035638328281
   67544.451320557870       -18968.556384017440
   67520.810436121450       -15528.332045581064
   67192.674084509898       -12192.737960214727
   66588.551655017625       -8995.3643609218143
   65740.405487642915       -5962.6964012979060
   64681.913134164082       -3114.1185781094669
   63446.943710423664       -462.31459723260878
   62068.317115593192        1986.0510920077445
   60576.870953356098        4229.4828670330016
   59000.825380139227        6270.7334012184383
   57366.903291307404        8114.3172350914019
   55694.241580143607        9772.1194852867357
   54003.263167775673        11252.698036229067
   52309.962790707919        12567.449032396482
   50627.575131989106        13728.335663780070
   48966.841773134758        14747.473586049331
   47336.298180069134        15636.815378107489
   45742.561575554180        16407.920287237321
   44190.606651501505        17071.794878148059
   42684.020965543619        17638.790836150809
   41225.235589002521        18118.547534901089
   39816.974412244606        18519.640375384184
   38457.406302433097        18850.955409217950
   37147.904064191942        19119.553900705323
   35888.058413376850        19332.209682485223
   34677.076866735981        19495.053747499845
   33513.874516036783        19613.618164293730
   32397.148967943020        19692.881862284245
   31325.441701452120        19737.316496285679
   30297.187891304839        19750.931143297028
   29311.625308100931        19737.338491455372
   28365.315805162700        19699.721327910407
   27457.490888904023        19640.947633605934
   26586.487166755753        19563.577016849227
   25750.667146390966        19469.892763992728
   24948.430661769384        19361.930557216456
   24178.223281018523        19241.504491701242
   23438.542280205093        19110.230558420601
   22727.940666373528        18969.547775666080
   22045.029648174368        18820.737158595985
   21389.058845562158        18665.081648144413
   20757.578706600292        18503.314532194388
   20149.980938910361        18336.475011995248
   19565.113422321596        18165.365060678592
   19001.880861822003        17990.697362601364
   18459.243042495797        17813.104956781110
   17936.212869745839        17633.149831403251
   17431.854267912313        17451.330581929178
   16945.279995087883        17268.089234244613
   16475.649419460944        17083.817323970437
   16022.166292394902        16898.861313559166
   15584.463812255535        16713.694173632724
   15161.040505832598        16528.252657825920
   14751.620996849602        16342.941504745138
   14355.565018944386        16157.970228412602
   13972.266246714134        15973.522712770042
   13601.150425646325        15789.759937919922
   13241.673586917534        15606.822414475489
   12893.320348041279        15424.832358142119
   12555.602299072161        15243.895633042952
   12228.056473101240        15064.103489096331
   11910.525455471119        14885.694129836218
   11602.021592717074        14708.412860948534
   11302.439980421941        14532.476930574956
   11011.405717279549        14357.933129811176
   10728.562877681850        14184.819936169008
   10453.573432360470        14013.168408245447
   10186.116232708526        13843.002987721242
   9925.8860554238545        13674.342218515965
   9672.5927041805189        13507.199391846489
   9426.1790442882120        13341.731373058486
   9185.9390526466523        13177.644750998455
   8951.8474849155846        13015.089926590665
   8723.6662897862298        12854.064407089892
   8501.1686992282448        12694.562805388350
   8284.1386092047396        12536.577177496652
   8072.3699975904128        12380.097325604132
   7865.6663769910665        12225.111070230285
   7663.8402802932405        12071.604494608027
   7466.7127768990586        11919.562164109484
   7274.2842343291559        11769.102105262260
   7086.0451699152873        11619.935577170396
   6902.0148462641682        11472.179771483014
   6722.0441839961686        11325.814960724587
   6545.9906186860926        11180.820701715991
   6373.7177647067301        11037.175949883040
EOF
./test_values.sh stereo3.tmp answer.tmp 2 "stereo_project: lon-lat to x-y" || exit 1

gmt makecpt -Cviridis -T1/`wc lola.tmp | awk '{print $1}'`/1 > junk.cpt
gmt makecpt -Cmagma -T1/`wc lola.tmp | awk '{print $1}'`/1 > junk3.cpt

PSFILE="test_stereo_project.ps"

PROJ="-JX3i"
LIMS="-R-5/5/-5/5"
echo 0 0 | gmt psxy $PROJ $LIMS -K > $PSFILE
awk '{print $1/'"$RADIUS"',$2/'"$RADIUS"',NR}' stereo.tmp | gmt psxy $PROJ $LIMS -Sc0.03i -Cjunk.cpt -K -O >> $PSFILE
awk '{print $1/'"$RADIUS"',$2/'"$RADIUS"',NR}' stereo3.tmp | gmt psxy $PROJ $LIMS -Sc0.03i -Cjunk3.cpt -K -O >> $PSFILE
awk '{print $1/'"$RADIUS"',$2/'"$RADIUS"',NR}' stereo2.tmp | gmt psxy $PROJ $LIMS -W1p -K -O >> $PSFILE
gmt psbasemap $PROJ $LIMS -Bxa1 -Bya1 -K -O >> $PSFILE


$BIN_DIR/stereo_project -f stereo.tmp -stereo2geo -lon0 0 -lat0 -90 -radius $RADIUS > inverse.tmp
$BIN_DIR/stereo_project -f stereo3.tmp -stereo2geo -lon0 0 -lat0 -90 -radius $RADIUS > inverse3.tmp
cat > answer.tmp << EOF
   29.999999999999996       -4.7003039751659201E-016
   29.657964345367343      -0.93964540580853817
   29.315744626888236       -1.8792573138407742
   28.973156410605554       -2.8188021553744971
   28.630014520890274       -3.7582462194933162
   28.286132665970428       -4.6975555812327316
   27.941323059073778       -5.6366960288112908
   27.595396033681222       -6.5756329896330907
   27.248159651353163       -7.5143314547381959
   26.899419300546089       -8.4527559013672366
   26.548977284782683       -9.3908702132938036
   26.196632398474854       -10.328637598561471
   25.842179488623575       -11.266020504245482
   25.485409000534990       -12.202980527836909
   25.126106505593764       -13.139478324823516
   24.764052209025586       -14.075473512014256
   24.399020435457988       -15.010924566122739
   24.030779089951569       -15.945788717091279
   23.659089092022352       -16.880021835596768
   23.283703780008448       -17.813578314137327
   22.904368282949395       -18.746410941048982
   22.520818856944004       -19.678470766747743
   22.132782182730335       -20.609706961432025
   21.739974620988200       -21.540066663413327
   21.342101421599949       -22.469494817167927
   20.938855882816348       -23.397934000120074
   20.529918455961106       -24.325324237074536
   20.114955790967997       -25.251602801114302
   19.693619717677336       -26.176703999666188
   19.265546157422783       -27.100558944309974
   18.830353959014488       -28.023095302768635
   18.387643652769370       -28.944237031360579
   17.936996115754692       -29.863904086023666
   17.477971140896443       -30.782012109829914
   17.010105902063145       -31.698472094697625
   16.532913306668856       -32.613190014773686
   16.045880226753518       -33.526066428698890
   15.548465598899250       -34.436996047680310
   15.040098382738188       -35.345867265978242
   14.520175367214359       -36.252561650060926
   13.988058813195689       -37.156953382293999
   13.443073920517747       -38.058908654601538
   12.884506107107759       -38.958285007066181
   12.311598087527804       -39.854930605918049
   11.723546738142065       -40.748683454797877
   11.119499736221441       -41.639370532563689
   10.498551960737281       -42.526806850243211
   9.8597416434732725       -43.410794419013953
   9.2020462605400688       -44.291121120323972
   8.5243781565852554       -45.167559468448914
   7.8255798971721680       -46.039865254928557
   7.1044193492271406       -46.907776063444089
   6.3595844954678542       -47.771009642813219
   5.5896779967438821       -48.629262124913943
   4.7932115267626294       -49.482206073544994
   3.9685999173689153       -50.329488349541357
   3.1141551701585581       -51.170727776964135
   2.2280804126526053       -52.005512594971449
   1.3084639056261835       -52.833397680182969
  0.35327324374913627       -53.653901525144967
 -0.63965006408396829       -54.466502960106553
  -1.6725953938354843       -55.270637608010880
  -2.7479868773151672       -56.065694066744427
  -3.8683859570478121       -56.851009818716122
  -5.0364921407724470       -57.625866876296200
  -6.2551413579860649       -58.389487183190660
  -7.5273011897165683       -59.141027807228760
  -8.8560620940422599       -59.879575980179879
  -10.244623586192333       -60.604144066059312
  -11.696274158777943       -61.313664571934503
  -13.214363554567859       -62.006985355439120
  -14.802265846942257       -62.682865231772503
  -16.463331665302697       -63.339970240176378
  -18.200827857565976       -63.976870895226504
  -20.017862953987105       -64.592040820013509
  -21.917297042190892       -65.183857232880172
  -23.901635148746120       -65.750603830881758
  -25.972904019061307       -66.290476672558526
  -28.132513360584813       -66.801593697492351
  -30.381104207772911       -67.282008514516235
  -32.718389078456418       -67.729729025694098
  -35.142990942023481       -68.142741309841682
  -37.652290526859353       -68.519038950617585
  -40.242293848167101       -68.856657650906570
  -42.907533603555521       -69.153714531886763
  -45.641018743422173       -69.408450996084142
  -48.434245559433947       -69.619277486768837
  -51.277280666147249       -69.784817972122283
  -54.158921187158832       -69.903951608137191
  -57.066930627492759       -69.975848876350213
  -59.988341113422933       -69.999999618759503
  -62.910067429785350       -69.976226539517484
  -65.818494568565157       -69.904695651365444
  -68.700646767931573       -69.785914660053379
  -71.544277328617895       -69.620710927140749
  -74.335684376340325       -69.410412757634873
  -77.069953396297407       -69.156015065963302
  -79.736029482294214       -68.859275334294139
  -82.326907015879812       -68.521951417129969
  -84.837104849226492       -68.145925859189617
  -87.262616306369594       -67.733162990055661
  -89.600810868388919       -67.285669573308837
  -91.850301857843775       -66.805460135961027
  -94.010793788805117       -66.294527584090403
  -96.082921288035678       -65.754819266204024
  -98.066342417027215       -65.188739369163045
  -99.966649098171004       -64.597072593505786
  -101.78451945960173       -63.982034175960614
  -103.52281187547982       -63.345248127100035
  -105.18463406364965       -62.688242031322829
  -106.77325278761136       -62.012446542517047
  -108.29201916539751       -61.319196738434997
  -109.74430819724965       -60.609734861213980
  -111.13347087651792       -59.885214046124794
  -112.46279717488601       -59.146702712457333
  -113.73548823746691       -58.395189355905181
  -114.95356303962748       -57.632279404418206
  -116.12218150799404       -56.857442544194740
  -117.24306145510931       -56.072138943016576
  -118.31890424652391       -55.277087256050415
  -119.35227313577950       -54.472950611893012
  -120.34559400233834       -53.660340971169028
  -121.30115789520246       -52.839823220958266
  -122.22112489683197       -52.011918996436442
  -123.10752891838609       -51.177110229601162
  -123.96228311801394       -50.335842431005062
  -124.78645677865076       -49.489292288350711
  -125.58322158886483       -48.636317084054646
  -126.35340898037936       -47.778029586913696
  -127.09850845152754       -46.914757523414750
  -127.81991843369713       -46.046805026826775
  -128.51895196086321       -45.174454590649979
  -129.19684211163167       -44.297968852793538
  -129.85474719921015       -43.417592224490363
  -130.49375569529175       -42.533552377151736
  -131.11434004391802       -41.646861192677022
  -131.71857918564089       -40.756120469740793
  -132.30681247438974       -39.862311932673613
  -132.87989288565296       -38.965608744573892
  -133.43862414942060       -38.066173032351230
  -133.98376411449829       -37.164156749939906
  -134.51602788653412       -36.259702467958896
  -135.03609075245049       -35.352944096558119
  -135.54459090408614       -34.444007547574493
  -136.04213197371746       -33.533011341555238
  -136.52885180848614       -32.620889000759135
  -137.00616762748089       -31.706103827756394
  -137.47415024406558       -30.789575470461553
  -137.93328709075013       -29.871398023335466
  -138.38404131077476       -28.951660558112106
  -138.82685340720766       -28.030447490824670
  -139.26214277942995       -27.107838920465017
  -139.69030915547310       -26.183910941807291
  -140.11173392810980       -25.258735934692005
  -140.52678140205299       -24.332382831854556
  -140.93579995910721       -23.404917367191594
  -141.33876290877780       -22.477237755098628
  -141.73671515782547       -21.547733972700929
  -142.12959837860006       -20.617298010847840
  -142.51770749531360       -19.685984958617819
  -142.90132631073024       -18.753847709098462
  -143.28072829765100       -17.820937121494730
  -143.65617734430029       -16.887302172945375
  -144.02792845738355       -15.952990100955700
  -144.39622842631891       -15.018046537279229
  -144.76098950824408       -14.083357189732096
  -145.12310037606250       -13.147282209205164
  -145.48245709081195       -12.210704187143667
  -145.83927955320343       -11.273663526668059
  -146.19378229170837       -10.336199591029620
  -146.54617495519051       -9.3983508003663534
  -146.89666278549893       -8.4601547241965260
  -147.24544707209245       -7.5216481701030729
  -147.59272559065616       -6.5828672690354919
  -147.93869302757341       -5.6438475576316085
  -148.28323172237089       -4.7054687645555369
  -148.62715149888717       -3.7660761982588391
  -148.97032961825050       -2.8265486214206264
  -149.31295243334142       -1.8869199702389015
  -149.65520517739085      -0.94722396619029792
  -149.99727233864948       -7.4941879230175446E-003
  -150.33933803213412       0.93223585745970006
  -150.68158636991063        1.8719326634200666
  -151.02420183136542        2.8115626530093403
  -151.36736963491663        3.7510921075910981
  -151.71096645627415        4.6896423859219061
  -152.05579851474144        5.6288688546831338
  -152.40174660269807        6.5678920899983391
  -152.74900268990814        7.5066770773933671
  -153.09776141685109        8.4451882890571497
  -153.44822050664317        9.3833896041577720
  -153.80058118929793        10.321244226565371
  -154.15504864010288        11.258714599600621
  -154.51183243397347        12.195762317407626
  -154.87114701774365        13.132348032524748
  -155.23288530150725        14.067589795679204
  -155.59792399713766        15.003129716598519
  -155.96617087916454        15.938082990806336
  -156.33786503226290        16.872405488820753
  -156.71325311997262        17.806051603457924
  -157.09259001282294        18.738974123852632
  -157.47613945197230        19.671124101706461
  -157.86417475161954        20.602450708997853
  -158.25697954368687        21.532901086322351
  -158.65484856853814        22.462420180955910
  -159.05808851578644        23.390950573651349
  -159.46664852132446        24.317598716454675
  -159.88159714350462        25.243970068652679
  -160.30291738587405        26.169164398023973
  -160.73097329024802        27.093112824751923
  -161.16614596729116        28.015743026023316
  -161.60883484235617        28.936978968526077
  -162.05945899010010        29.856740619523450
  -162.51845856522633        30.774943634422868
  -162.98629633724349        31.691499018548210
  -163.46302589349725        32.605490898105927
  -163.95001809863777        33.518465274463168
  -164.44738908791999        34.429493408789874
  -164.95570979845974        35.338463719643919
  -165.47558333089293        36.245257799726893
  -166.00764730643357        37.149749859714049
  -166.55257639949622        38.051806122067809
  -167.11108505823799        38.951284159803528
  -167.68393042568812        39.848032174657575
  -168.27191547426787        40.741888208544175
  -168.87589236639690        41.632679281571413
  -169.49619983971908        42.519423818892768
  -170.13491540116220        43.403520333874816
  -170.79251073361061        44.283957133009636
  -171.47007323322998        45.160506800554444
  -172.16876006136394        46.032925203576873
  -172.88980306410772        46.900950007264001
  -173.63451395811933        47.764299048374561
  -174.40428976880489        48.622668553645433
  -175.20061849648198        49.475731189156356
  -176.02433040804098        50.322374527637280
  -176.87859467320729        51.163741921162099
  -177.76447919336155        51.998657110344126
  -178.68389524694680        52.826675140363321
  -179.63887477534294        53.647314685184114
   179.36842419102197        54.460054770008504
   178.33571272526913        55.264331226867590
   177.26056712247839        56.059532877351920
   176.14042633147938        56.844997442493863
   174.97259118374780        57.620007188259876
   173.75534524720865        58.383102769955656
   172.48353212830594        59.134815909113200
   171.15513399207279        59.873542170968591
   169.76695129174513        60.598294294437594
   168.31569527651092        61.308005173352456
   166.79801566243518        62.001523059461491
   165.21053748751555        62.677607163257917
   163.54990881392177        63.334923912295295
   161.81286098639438        63.972044191979379
   159.99628308475417        64.587441965574271
   158.09731196427379        65.179494744803890
   156.11526164354038        65.745988361512531
   154.04453397496272        66.286140191813303
   151.88545865371754        66.797546837945291
   149.63738752783777        67.278261842829465
   147.30059997600529        67.726292853553943
   144.87646403674825        68.139625471830755
   142.36758928054161        68.516252551685483
   139.77795955344379        68.854208789166748
   137.11303194671808        69.151610005948356
   134.38227388761223        69.406486116376016
   131.58925725752951        69.617705611991838
   128.74633506028331        69.783641431632262
   125.86470353208250        69.903170155439426
   122.95659513282084        69.975459525411196
   120.03497665632113        69.999996568835755
   117.11319769680379        69.976605488070021
   114.20461242877893        69.905453889487163
   111.32220106431134        69.787046843652220
   108.47821739334360        69.622209261214920
   105.68637297996408        69.412266939511355
   102.95159239830353        69.158213555798767
   100.28494274066945        68.861804734773273
   97.693441825922690        68.524797157723327
   95.182582835064906        68.149072548458292
   92.756383868519052        67.736594745614795
   90.417485932166514        67.289370318265767
   88.167285037565392        66.809413854982154
   86.006084739711071        66.298718536144747
   83.933257189756986        65.759232154198116
   81.949150462587568        65.193359289088903
   80.048175761323407        64.601885679085967
   78.229658896396188        63.987027094487637
   76.490743889112125        63.350408306742729
   74.828324631396782        62.693557674038132
   73.239135312739705        62.017906620042289
   71.719825230759611        61.324790975425294
   70.267019370646850        60.615453708998210
   68.877366387859027        59.891048649962393
   67.547575702914671        59.152644874627775
   66.274445373434943        58.401231496469869
   65.055955855414041        57.638414440443178
   63.886945456011823        56.863664097229531
   62.765695673161979        56.078441046538693
   61.689504042953459        55.283464404543068
   60.655806210583172        54.479397725069958
   59.662175209070966        53.666853360242214
   58.706318927981208        52.846396557059613
   57.786076258377634        52.018549281225035
   56.899412303692493        51.183793768030071
   56.045168171699785        50.343335074499230
   55.220008269261733        49.496072297775171
   54.423025266514003        48.643140842779459
   53.652631942563616        47.784894380944081
   52.907338049510223        46.921660835242690
   52.185744452433923        46.053744519133517
   51.486537458182276        45.181428091416379
   50.808483371398495        44.304974341703620
   50.150423302473413        43.424627820520300
   49.511268241506585        42.540616327241295
   48.890545363540078        41.653951838063257
   48.286175010653011        40.763236307823057
   47.697817520490858        39.869451535674209
   47.124619510687467        38.972770776408332
   46.565776872147495        38.073356241429245
   46.020531402877801        37.171359962581711
   45.488167668206358        36.266924582370912
   44.968010074696835        35.360184077315971
   44.459420144956383        34.451264420567618
   43.961793980663536        33.540284189350757
   43.474559901450448        32.627355122275738
   42.997601280171246        31.713406066135601
   42.529546194824285        30.796891231227733
   42.070340668197694        29.878726576481228
   41.619521370028309        28.959001212193986
   41.176647622919020        28.037799590151860
   40.741299864990275        27.115201842503897
   40.313078216743655        26.191284094783015
   39.891601144233654        25.266118755368712
   39.476504211187326        24.339774783479683
   39.067438913224343        23.412317937588423
   38.664431865222312        22.484646447797800
   38.266437974810970        21.555150326997332
   37.873515511557912        20.624721578133233
   37.485369459246641        19.693415308477839
   37.101715929616624        18.761284427975795
   36.722281370494734        17.828379811438126
   36.346801820056506        16.894750450437517
   35.975022203445171        15.960443595811917
   35.606695668243319        15.025504891611689
   35.241909920568091        14.090820053067439
   34.879776189665797        13.154749249576849
   34.520398388454609        12.218175077896303
   34.163556571342816        11.281137949840497
   33.809036168993195        10.343677236564533
   33.456627495522810        9.4058313653565158
   33.106125275758501        8.4676379121625764
   32.757328190476940        7.5291336903001911
   32.410038437668071        6.5903548357856474
   32.064061307957544        5.6513368896775349
   31.719514448739229        4.7129595832204574
   31.375588004902617        3.7735682307242109
   31.032404709859215        2.8340415959944099
   30.689778200282969        1.8944136172327573
   30.347523235500866       0.95471801734279660
   30.005455322794440        1.4988375829024637E-002
EOF
./test_values.sh inverse3.tmp answer.tmp 2 "stereo_project: x-y to lon-lat" || exit 1

PROJ="-JR4i"
LIMS="-Rg"
echo 0 0 | gmt psxy $PROJ $LIMS -K -O -X4i >> $PSFILE
awk '{print $1,$2,NR}' inverse.tmp | gmt psxy $PROJ $LIMS -Sc0.03i -Cjunk.cpt -K -O >> $PSFILE
awk '{print $1,$2,NR}' inverse3.tmp | gmt psxy $PROJ $LIMS -Sc0.03i -Cjunk3.cpt -K -O >> $PSFILE
gmt psbasemap $PROJ $LIMS -Bxa30 -Bya30 -K -O >> $PSFILE
echo 0 0 | gmt psxy $PROJ $LIMS -O >> $PSFILE

ps2pdf $PSFILE
rm $PSFILE
rm gmt.*
rm *.tmp
rm *.cpt
